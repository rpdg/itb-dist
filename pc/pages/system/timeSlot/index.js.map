{"version":3,"sources":["/pages/system/timeSlot/index.ts"],"names":[],"mappings":";;;;AAAA,oCAA4B;AAE5B,+CAA4C;AAI5C,+CAAyC;AAEzC,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAS,CAAC,CAAC;AAErC,gBAAG,CAAC,GAAG,CAAC;IACP,YAAY,EAAE,uBAAuB;IACrC,WAAW,EAAE,0BAA0B;IACvC,OAAO,EAAE,0BAA0B;IACnC,cAAc,EAAE,yBAAyB;CACzC,CAAC,CAAC;AAEH,IAAM,GAAG,GAAG,qBAAS,CAAC,OAAO,CAAC;AAE9B,IAAM,UAAU,GAAG,GAAG,CAAC,gBAAgB,CAAC;AAExC,IAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC;AAE9B,IAAI,KAAK,GAAU,gBAAG,CAAC,SAAS,CAAC,QAAQ,EAAE;IAC1C,KAAK,EAAE,KAAG,GAAG,CAAC,qBAAuB;IACrC,aAAa,EAAE,KAAG,GAAG,CAAC,IAAM;IAC5B,cAAc,EAAE;QACf,IAAI,KAAK,GAAG,QAAQ,CAAC,YAAY,CAAC;YACjC,SAAS,EAAE;gBACV,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE,GAAG,CAAC,gBAAgB;aAC1B;YACD,OAAO,EAAE;gBACR,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE,GAAG,CAAC,cAAc;aACxB;SACD,CAAC,CAAC;QAEH,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACX,gBAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;QACnD,CAAC;IACF,CAAC;CACD,CAAC,CAAC;AAEH,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,qBAAS,CAAC,OAAO,CAAC,CAAC;AAEnD,gBAAG,CAAC,GAAG,CAAC,OAAO,CAAC,cAAI;IACnB,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;IAE5B,CAAC,CAAC,YAAY,CAAC,CAAC,cAAc,CAAC;QAC9B,UAAU,EAAE,KAAK;QACjB,iBAAiB,EAAE,IAAI;QACvB,MAAM,EAAE,gBAAgB;KACxB,CAAC,CAAC;IAEH,CAAC,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC;QAC5B,UAAU,EAAE,KAAK;QACjB,iBAAiB,EAAE,IAAI;QACvB,MAAM,EAAE,gBAAgB;KACxB,CAAC,CAAC;AAEJ,CAAC,CAAC,CAAC;AAEH,wBAAwB;AACxB,IAAM,QAAQ,GAAG;IAChB,CAAC,EAAE,EAAE;IACL,CAAC,EAAE,GAAG,CAAC,GAAG;IACV,CAAC,EAAE,GAAG,CAAC,MAAM;CACb,CAAC;AACF,IAAI,MAAM,GAAU,gBAAG,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC;IACxC,GAAG,EAAE,gBAAG,CAAC,GAAG,CAAC,YAAY;IACzB,KAAK,EAAE,EAAC,eAAe,EAAE,CAAC,EAAC;IAC3B,QAAQ,EAAE;QACT,KAAK,EAAE,KAAG,UAAU,GAAG,GAAG,CAAC,IAAM;QACjC,OAAO,EAAE;YACR,EAAC,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,YAAY,EAAE,IAAI,EAAE,sCAAkC,GAAG,CAAC,GAAK,EAAC;SAC1F;KACD;IACD,OAAO,EAAE;QACR;YACC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG;YACtB,GAAG,EAAE,IAAI;SACT;QACD;YACC,IAAI,EAAE,KAAG,GAAG,CAAC,SAAW;YACxB,GAAG,EAAE,WAAW;YAChB,KAAK,EAAE,GAAG;SACV;QACD;YACC,IAAI,EAAE,KAAG,GAAG,CAAC,OAAS;YACtB,GAAG,EAAE,SAAS;YACd,KAAK,EAAE,GAAG;SACV;QACD;YACC,IAAI,EAAE,GAAG,CAAC,IAAI;YACd,GAAG,EAAE,MAAM;SACX;QACD;YACC,IAAI,EAAE,GAAG,CAAC,QAAQ;YAClB,GAAG,EAAE,UAAU;YACf,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,WAAC,IAAI,eAAQ,CAAC,CAAC,CAAC,EAAX,CAAW;SACxB;QACD;YACC,IAAI,EAAE,GAAG,CAAC,OAAO;YACjB,GAAG,EAAE,IAAI;YACT,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,UAAC,EAAE,EAAE,KAAK,EAAE,GAAG;gBACtB,MAAM,CAAC,uBAAoB,EAAE,wBAAiB,GAAG,CAAC,QAAQ,CAAC,uCAA+B,GAAG,CAAC,IAAI,8CAC/E,EAAE,yCAAiC,GAAG,CAAC,GAAG,eAAY,CAAC;YAC3E,CAAC;SACD;KACD;IACD,UAAU,EAAE,KAAK;CACjB,CAAC,CAAC;AAGH,MAAM;AACN,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,WAAW,EAAE;IACrC,IAAI,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC7C,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAClB,IAAI,sBAAY,CAAC,MAAM,EAAG,IAAI,CAAC,CAAC;AACjC,CAAC,CAAC,CAAC;AAGH,QAAQ;AACR,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,aAAa,EAAE;IAAA,iBAQvC;IAPA,gBAAG,CAAC,OAAO,CAAI,GAAG,CAAC,aAAa,MAAG,EAAI;QAEtC,IAAI,GAAG,GAAG,CAAC,CAAC,KAAI,CAAC,EAAE,EAAE,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvC,gBAAG,CAAC,GAAG,CAAC,WAAW,CAAC,EAAC,EAAE,MAAC,EAAE;YACzB,MAAM,CAAC,MAAM,EAAE,CAAC;QACjB,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC,CAAC;AAGH,KAAK;AACL,CAAC,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC;IAClB,IAAI,sBAAY,CAAC,MAAM,CAAC,CAAC;AAC1B,CAAC,CAAC,CAAC","file":"index.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Panel from 'ts/ui/Panel.ts';\r\nimport {Languages} from 'ts/util/Languages';\r\n\r\nimport Table from 'ts/ui/Table';\r\nimport Popup from 'ts/ui/Popup';\r\nimport TimeModifier from './TimeModifier'\r\n\r\nconsole.log('Languages:', Languages);\r\n\r\nopg.api({\r\n\tgetTimeSlots: 'timeslot/GetTimeSlots',\r\n\tdelTimeSlot: 'timeslot/DelTimeSlotById',\r\n\tgetDate: 'system/GetExhibitionDate',\r\n\t'setDate!post': 'system/UpExhibitionDate',\r\n});\r\n\r\nconst lpg = Languages.package;\r\n\r\nconst moduleName = lpg.timeSlotsSetting;\r\n\r\nlet formDate = $('#formDate');\r\n\r\nlet panel: Panel = opg.wrapPanel(formDate, {\r\n\ttitle: `${lpg.exhibitionDateSetting}`,\r\n\tbtnSearchText: `${lpg.save}`,\r\n\tbtnSearchClick: function () {\r\n\t\tlet param = formDate.fieldsToJson({\r\n\t\t\tbeginDate: {\r\n\t\t\t\trequire: true,\r\n\t\t\t\tname: lpg.beginDateSetting,\r\n\t\t\t},\r\n\t\t\tendDate: {\r\n\t\t\t\trequire: true,\r\n\t\t\t\tname: lpg.endDateSetting,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tif (param) {\r\n\t\t\topg.api.setDate([param.beginDate, param.endDate]);\r\n\t\t}\r\n\t},\r\n});\r\n\r\njQuery.datetimepicker.setLocale(Languages.current);\r\n\r\nopg.api.getDate(data => {\r\n\tformDate.jsonToFields(data);\r\n\r\n\t$('#beginDate').datetimepicker({\r\n\t\ttimepicker: false,\r\n\t\tcloseOnDateSelect: true,\r\n\t\tformat: 'Y-m-d 00:00:00',\r\n\t});\r\n\r\n\t$('#endDate').datetimepicker({\r\n\t\ttimepicker: false,\r\n\t\tcloseOnDateSelect: true,\r\n\t\tformat: 'Y-m-d 00:00:00',\r\n\t});\r\n\r\n});\r\n\r\n//[时间段性质,0为空，1为组委会，2自定义]\r\nconst slotType = {\r\n\t0: '',\r\n\t1: lpg.org,\r\n\t2: lpg.custom,\r\n};\r\nlet tbTime :Table = opg('#tbTime').table({\r\n\tapi: opg.api.getTimeSlots,\r\n\tparam: {informationType: 1},\r\n\ttitleBar: {\r\n\t\ttitle: `${moduleName}${lpg.list}`,\r\n\t\tbuttons: [\r\n\t\t\t{id: 'btnAdd', className: 'btn-create', html: `<i class=\"ico ico-create\"></i> ${lpg.add}`},\r\n\t\t],\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: 'ID', width: 100,\r\n\t\t\tsrc: 'id',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.beginTime}`,\r\n\t\t\tsrc: 'begintime',\r\n\t\t\twidth: 150,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.endTime}`,\r\n\t\t\tsrc: 'endtime',\r\n\t\t\twidth: 150,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.info,\r\n\t\t\tsrc: 'info',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.slotType,\r\n\t\t\tsrc: 'slottype',\r\n\t\t\twidth: 160,\r\n\t\t\trender: v => slotType[v],\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.process,\r\n\t\t\tsrc: 'id',\r\n\t\t\twidth: 120,\r\n\t\t\trender: (id, index, row) => {\r\n\t\t\t\treturn `<button data-id=\"${id}\" data-index=\"${row[':index']}\" class=\"btn-mini btn-info\">${lpg.edit}</button> \r\n\t\t\t\t<button data-id=\"${id}\" class=\"btn-mini btn-danger\">${lpg.del}</button> `;\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n\tpagination: false,\r\n});\r\n\r\n\r\n//edit\r\ntbTime.tbody.on('click', '.btn-info', function () {\r\n\tlet btn = $(this), index = btn.data('index');\r\n\tlet item = tbTime.data[index];\r\n\tconsole.log(item);\r\n\tnew TimeModifier(tbTime , item);\r\n});\r\n\r\n\r\n//delete\r\ntbTime.tbody.on('click', '.btn-danger', function () {\r\n\topg.confirm(`${lpg.slotDeleteTip}?` ,  () =>{\r\n\r\n\t\tlet btn = $(this), id = btn.data('id');\r\n\t\topg.api.delTimeSlot({id}, ()=>{\r\n\t\t\ttbTime.update();\r\n\t\t})\r\n\t});\r\n});\r\n\r\n\r\n//Add\r\n$('#btnAdd').click(function () {\r\n\tnew TimeModifier(tbTime);\r\n});\r\n\r\n"]}
{"version":3,"sources":["/pages/logistics/cateringRental/manage.ts"],"names":[],"mappings":"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","file":"manage.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Panel from 'ts/ui/Panel.ts';\r\nimport Table from 'ts/ui/Table.ts';\r\nimport {Combo} from 'ts/ui/Combo';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport {store} from '../../../ts/util/store';\r\nimport PopUp from \"../../../ts/ui/Popup\";\r\nimport {url} from \"../../../ts/util/utils\";\r\n\r\nconsole.log('Languages:', Languages);\r\n\r\nopg.api({\r\n    'getExhibitionOrBuyerBarcodeByUserId':'operation/GetExhibitionOrBuyerBarcodeByUserId',\r\n    'getcateringlist!post': 'Operation/Getcateringlist',\r\n    'addApproval!post': 'Operation/AddApproval',\r\n});\r\n\r\nconst lpg = Languages.package;\r\n\r\nconst form = $('#tbSearch');\r\n\r\n\r\nlet clng='en';\r\n\r\nif(localStorage.getItem(\"lngPkg\")!=null|| localStorage.getItem(\"lngPkg\")!=undefined)\r\n{\r\n    const currentlng=localStorage.getItem(\"lngPkg\");\r\n    clng=currentlng.replace(/[\"\"\"]/g,\"\");\r\n}\r\n\r\n\r\n$(\"#totalsum\").html(lpg.totalsum + \":0\");\r\n\r\nlet panel: Panel = opg.wrapPanel('#tbSearch', {\r\n\ttitle: `${lpg.searchService}`,\r\n\tbtnSearchText: `<i class=\"ico-find\"></i> ${lpg.search}`,\r\n\tbtnSearchClick: function () {\r\n        refreshtable();\r\n\t}\r\n});\r\n\r\nfunction refreshtable() {\r\n    let xparam = $('#tbSearch').fieldsToJson();\r\n    xparam.pageIndex = 0;\r\n    xparam.currentlng=clng;\r\n    tb.update(xparam);\r\n\r\n}\r\n\r\n\r\n//const permission = store.get('permission');\r\nlet tbButtons = [];\r\n\r\n\r\n\r\nlet tb: Table = opg('#tb').table({\r\n\tapi: opg.api.getcateringlist,\r\n\tlazy: true,\r\n\ttitleBar: {\r\n\t\ttitle: `${lpg.list}`,\r\n\t\tbuttons: tbButtons,\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: `${lpg.standno}`, width: 100,\r\n\t\t\tsrc: 'standno'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.exhibitor}`, width: 100,\r\n            src: 'exhibitor',\r\n            render:function(id,index,row) {\r\n                let html = `<a href=\"#\" class=\"href-c\" data-id=\"${row.userid}\">${row.exhibitor}</a>`;\r\n                return html;\r\n            }\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.company}`, width: 100,\r\n\t\t\tsrc: 'company',\r\n\t\t},\r\n        {\r\n            text: `${lpg.allreserveqty}`, width: 100,\r\n            src: 'allreserveqty',\r\n        },\r\n        {\r\n            text: `${lpg.allunitprice}`, width: 100,\r\n            src: 'allunitprice',\r\n        },\r\n        {\r\n            text: `${lpg.createtime}`, width: 100,\r\n            src: 'createtime',\r\n        },\r\n        {\r\n            text: `${lpg.approvaltime}`, width: 100,\r\n            src: 'approvaltime',\r\n        },\r\n        {\r\n            text: `${lpg.status}`, width: 100,\r\n            src: 'status',\r\n            render:function (id, index, row) {\r\n                let html = ``;\r\n                if (row.status==='0') {\r\n                    html += `<label class=\"apply\">${lpg.statustype[0]}</label>`;\r\n                }\r\n                else if(row.status==='1') {\r\n                    html += `<label class=\"agree\">${lpg.statustype[1]}</label>`;\r\n                }\r\n                else if(row.status==='2') {\r\n                    html += `<label class=\"deny\">${lpg.statustype[2]}</label>`;\r\n                }\r\n                return html;\r\n            },\r\n        },\r\n        {\r\n            text: `${lpg.operation}`, width: 100,\r\n            src: 'standno',\r\n            render:function (id, index, row) {\r\n                let html = `<button data-id=\"${row.standno}\" data-name=\"${row.company}|${row.createtime}\" class=\"btn-mini btn-info\" >${lpg.operationbutton}</button> `;\r\n\r\n                return html;\r\n            },\r\n        }\r\n\t],\r\n\tpagination: true,\r\n});\r\n\r\nrefreshtable();\r\n//view\r\n\r\nconst infoPage = __uri('/pages/logistics/cateringRental/view.html');\r\ntb.tbody.on('click', '.btn-info', function () {\r\n    let param = $('#tbSearch').fieldsToJson();\r\n    let btn = $(this), id = btn.data('id'), name = btn.data('name');\r\n    let companyname=name.split('|')[0];\r\n    let ctime=name.split('|')[1];\r\n    let pop = opg.popTop(`<iframe src=\"${url.setParam(infoPage,{standno:id,reservetype:param.reservetype,ctime:ctime})}\"></iframe>` , {\r\n        title: `${lpg.viewlist}: ${id}-${companyname}`,\r\n        btnMax: true,\r\n        width: 900,\r\n        height: 550,\r\n        buttons: {\r\n            agree: {\r\n                className: 'btn-success',\r\n                text: lpg.sendApproval,\r\n                onClick: function (i, ifr) {\r\n                    let approval = ifr.getApprovalFill();\r\n                    if (approval)\r\n                        sendApproval(approval, pop);\r\n                    return true;\r\n                }\r\n            },\r\n            deny: {\r\n                className: 'btn-danger',\r\n                text: lpg.sendDeny,\r\n                onClick: function (i, ifr) {\r\n                    let approval = ifr.getDenyFill();\r\n                    if (approval)\r\n                        sendApproval(approval, pop);\r\n                    return true;\r\n                }\r\n            },\r\n            cancel: lpg.cancel\r\n        },\r\n        onClose: function () {\r\n            tb.update();\r\n        }\r\n    });\r\n});\r\n\r\ntb.tbody.on('click', '.href-c', function () {\r\n    let btn = $(this), userid = btn.data('id');\r\n    let param={};\r\n    param.userid=userid;\r\n    opg.api.getExhibitionOrBuyerBarcodeByUserId(param, function (data) {\r\n        if(data.substr(0,1)===\"1\" || data.substr(0,1)===\"4\") {\r\n            top.window.open(\"../../itb/wishlist/barcode.html?barcode=\" + data + \"&type=exhibition\",\"_blank\");\r\n        }\r\n        else if(data.substr(0,1)===\"2\") {\r\n            top.window.open(\"../../itb/wishlist/barcode.html?barcode=\" + data + \"&type=buyer\",\"_blank\");\r\n        }\r\n    });\r\n});\r\n\r\nfunction sendApproval(approval, pop: PopUp) {\r\n    opg.api.addApproval(approval, function (data) {\r\n        pop.close();\r\n        tb.update();\r\n    });\r\n}\r\n\r\n"]}
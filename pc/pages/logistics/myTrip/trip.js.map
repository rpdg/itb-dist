{"version":3,"sources":["/pages/logistics/myTrip/trip.ts"],"names":[],"mappings":"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","file":"trip.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Panel from 'ts/ui/Panel.ts';\r\nimport Table from 'ts/ui/Table.ts';\r\nimport PopUp from \"../../../ts/ui/Popup\";\r\nimport {Combo} from 'ts/ui/Combo';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport {store} from '../../../ts/util/store';\r\nimport PopUp from \"../../../ts/ui/Popup\";\r\nimport {url} from \"../../../ts/util/utils\";\r\nimport {request, string, dateTime, is, url, convert, format, array} from  'ts/util/utils';\r\nimport {api} from \"../../../ts/util/api\";\r\n\r\n\r\n\r\nopg.api({\r\n    'gettriplistbyuser!post': 'Operation/Gettriplistbyuser',\r\n    'addtripbyuser!post':'Operation/Addtripbyuser',\r\n    getCurrentUserInfoAndMenus: 'user/GetCurrentUserInfoAndMenus',\r\n    getBuyerByBarCode:'buyer/GetBuyerByBarCode'\r\n});\r\n\r\nconst lpg = Languages.package;\r\n\r\nlet clng='en';\r\n\r\nif(localStorage.getItem(\"lngPkg\")!=null|| localStorage.getItem(\"lngPkg\")!=undefined)\r\n{\r\n    const currentlng=localStorage.getItem(\"lngPkg\");\r\n    clng=currentlng.replace(/[\"\"\"]/g,\"\");\r\n}\r\n\r\nlet curStage='';\r\nlet barcode='';\r\nlet param={};\r\nparam.type='1';\r\nopg.api.getCurrentUserInfoAndMenus(param, function (data){\r\n    curStage=data.stage[0].name;\r\n    barcode=data.barcode;\r\n    if(data.RoleId==\"2\") {\r\n        api.getBuyerByBarCode({barcode:barcode},function(data2) {\r\n            if(data2[0].N!=\"Fully\") {\r\n                let pop: PopUp = top.opg.alert(`${lpg.Content}`, function () {\r\n                    pop.close();\r\n                    location.href='../itb/dashboard/index.html';\r\n                }, {\r\n                    btnClose:false,\r\n                    title: `${lpg.Tips}`,\r\n                    buttons: {\r\n                        ok: `${lpg.okb}`\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\njQuery.datetimepicker.setLocale(Languages.current);\r\n$('#comedate,#leavedate').each(function (i, elem) {\r\n    $(elem).datetimepicker({\r\n        timepicker: false,\r\n        closeOnDateSelect: true,\r\n        format: 'Y-m-d'\r\n    });\r\n});\r\n$('#comearrivedate,#leavearrivedate').each(function (i, elem) {\r\n    $(elem).datetimepicker({\r\n        timepicker: true,\r\n        minuteStep:5,\r\n        minView:'minute',\r\n        //closeOnDateSelect: true,\r\n        format: 'Y-m-d H:m:s'\r\n    });\r\n});\r\n\r\n\r\nif(clng==\"en\") {\r\n    $(\"#tbMain2\").show();\r\n    $(\"#tbMain\").hide();\r\n    //$(\"#cntb\").hide();\r\n    $(\"#buttonSection\").hide();\r\n}\r\nelse {\r\n    $(\"#tbMain\").show();\r\n    $(\"#tbMain2\").hide();\r\n    //$(\"#cntb\").show();\r\n    $(\"#buttonSection\").show();\r\n}\r\n\r\n\r\nfunction refreshtable() {\r\n    let xparam = {}\r\n    xparam.pageIndex = 0;\r\n    xparam.currentlng=clng;\r\n    tb.update(xparam);\r\n}\r\n\r\n\r\n//const permission = store.get('permission');\r\nlet tbButtons = [];\r\n\r\n\r\n\r\nlet tb: Table = opg('#tb').table({\r\n    api: opg.api.gettriplistbyuser,\r\n    lazy: true,\r\n    titleBar: {\r\n        title: `${lpg.list}`,\r\n        buttons: tbButtons,\r\n    },\r\n    columns: [\r\n        {\r\n            text: `${lpg.comemethod}`, width: 50,\r\n            src: 'comemethod',\r\n        },\r\n        {\r\n            text: `${lpg.comemethodinfo}`, width: 50,\r\n            src: 'comemethodinfo',\r\n        },\r\n        {\r\n            text: `${lpg.comearrivedate}`, width: 50,\r\n            src: 'comearrivedate',\r\n        },\r\n        {\r\n            text: `${lpg.leavemethod}`, width: 100,\r\n            src: 'leavemethod'\r\n        },\r\n        {\r\n            text: `${lpg.leavemethodinfo}`, width: 50,\r\n            src: 'leavemethodinfo',\r\n        },\r\n        {\r\n            text: `${lpg.leavearrivedate}`, width: 100,\r\n            src: 'leavearrivedate',\r\n        },\r\n        {\r\n            text: `${lpg.paymethod}`, width: 100,\r\n            src: 'paymethod',\r\n        },\r\n        {\r\n            text: `${lpg.createtime}`, width: 100,\r\n            src: 'createtime',\r\n        },\r\n        {\r\n            text: `${lpg.status}`, width: 50,\r\n            src: 'status',\r\n            render:function (id, index, row) {\r\n                let html = ``;\r\n                if (row.status==='0') {\r\n                    html += `<label class=\"apply\">${lpg.statustype[0]}</label>`;\r\n                }\r\n                else if(row.status==='1') {\r\n                    html += `<label class=\"agree\">${lpg.statustype[1]}</label>`;\r\n                }\r\n                else if(row.status==='2') {\r\n                    html += `<label class=\"deny\">${lpg.statustype[2]}</label>`;\r\n                }\r\n                return html;\r\n            }\r\n        }\r\n    ],\r\n    pagination: true,\r\n});\r\n\r\n\r\n$(\"#btnReset\").click(function() {\r\n    location.reload(true);\r\n});\r\n\r\n$(\"#btnSaveMain\").click(function() {\r\n    let param=$(\"#tbMain\").fieldsToJson();\r\n\r\n    // if(param.comemethod==\"\" || param.leavemethod==\"\") {\r\n    //\r\n    //     top.opg.warn(Languages.package['tips6']);\r\n    // }\r\n    if(param.comemethod!=\"\" && (param.comedate==\"\" || param.comearrivedate==\"\"))\r\n    {\r\n        top.opg.warn(Languages.package['tips5']);\r\n    }\r\n    else if(param.leavemethod!=\"\" && (param.leavedate==\"\" || param.leavearrivedate==\"\")) {\r\n        top.opg.warn(Languages.package['tips5']);\r\n    }\r\n    // else if(param.paymethod==\"\") {\r\n    //     top.opg.warn(Languages.package['tips7']);\r\n    // }\r\n    else if(param.paymethod==\"支付宝\" && (param.zhifubaoname==\"\" || param.zhifubaoaccount==\"\"))\r\n    {\r\n        top.opg.warn(Languages.package['tips4']);\r\n    }\r\n    else if(param.paymethod==\"银行\" && (param.bankaccountname==\"\" || param.bankaccount==\"\" || param.bankname==\"\")) {\r\n        top.opg.warn(Languages.package['tips3']);\r\n    }\r\n    else {\r\n\r\n        opg.api.addtripbyuser(param, function (data) {\r\n            if(data) {\r\n                top.opg.warn(Languages.package['tips']);\r\n                setTimeout(function(){\r\n                    location.reload(true);\r\n                },1000);\r\n            }\r\n            else\r\n            {\r\n                top.opg.warn(Languages.package['tips2']);\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\n$('#paymethod').on('change',function(){\r\n//判断是否选取prompt属性，无返回值；\r\n    if($(this).val()==\"支付宝\"){\r\n        $(\".zhifubao\").attr(\"disabled\",false);\r\n        $(\".bank\").attr(\"disabled\",true);\r\n    }\r\n    else if($(this).val()==\"银行\")\r\n    {\r\n        $(\".zhifubao\").attr(\"disabled\",true);\r\n        $(\".bank\").attr(\"disabled\",false);\r\n    }\r\n    else\r\n    {\r\n        $(\".zhifubao\").attr(\"disabled\",true);\r\n        $(\".bank\").attr(\"disabled\",true);\r\n    }\r\n});\r\n\r\n\r\nlet param2={};\r\nparam2.currentlng=clng;\r\nparam2.pageIndex=0;\r\nparam2.pageSize=10;\r\napi.gettriplistbyuser(param2,data => {\r\n    if(data.results.length>0){\r\n        $(\"#comemethod\").val(data.results[0].comemethod);\r\n        $(\"#comecity\").val(data.results[0].comecity);\r\n        $(\"#comedate\").val(formatdate(data.results[0].comedate));\r\n        $(\"#comemethodinfo\").val(data.results[0].comemethodinfo);\r\n        $(\"#comearrivedate\").val(data.results[0].comearrivedate);\r\n        $(\"#leavemethod\").val(data.results[0].leavemethod);\r\n        $(\"#leavecity\").val(data.results[0].leavecity);\r\n        $(\"#leavedate\").val(formatdate(data.results[0].leavedate));\r\n        $(\"#leavemethodinfo\").val(data.results[0].leavemethodinfo);\r\n        $(\"#leavearrivedate\").val(data.results[0].leavearrivedate);\r\n        $(\"#paymethod\").val(data.results[0].paymethod);\r\n\r\n\r\n        if(data.results[0].paymethod==\"支付宝\"){\r\n            $(\".zhifubao\").attr(\"disabled\",false);\r\n            $(\".bank\").attr(\"disabled\",true);\r\n        }\r\n        else if(data.results[0].paymethod==\"银行\")\r\n        {\r\n            $(\".zhifubao\").attr(\"disabled\",true);\r\n            $(\".bank\").attr(\"disabled\",false);\r\n        }\r\n        else\r\n        {\r\n            $(\".zhifubao\").attr(\"disabled\",true);\r\n            $(\".bank\").attr(\"disabled\",true);\r\n        }\r\n        $(\"#zhifubaoname\").val(data.results[0].zhifubaoname);\r\n        $(\"#zhifubaoaccount\").val(data.results[0].zhifubaoaccount);\r\n        $(\"#bankaccountname\").val(data.results[0].bankaccountname);\r\n        $(\"#bankaccount\").val(data.results[0].bankaccount);\r\n        $(\"#bankname\").val(data.results[0].bankname);\r\n    }\r\n});\r\n\r\n\r\n\r\n//refreshtable();\r\n\r\n\r\n\r\nfunction formatdate(mydate) {\r\n    var newdate;\r\n    var data = new Date(mydate);\r\n    var year = data.getFullYear();  //获取年\r\n    var month = data.getMonth() + 1;    //获取月\r\n    var day = data.getDate(); //获取日\r\n    if(month<10) {\r\n        if(day<10)\r\n            newdate= year+\"-0\"+month+\"-0\"+day;\r\n        else\r\n            newdate= year+\"-0\"+month+\"-\"+day;\r\n    }\r\n    else {\r\n        if(day<10)\r\n            newdate = year + \"-\" + month+\"-0\"+day;\r\n        else\r\n            newdate = year + \"-\" + month + \"-\" + day;\r\n    }\r\n    return newdate;\r\n}\r\n"]}
{"version":3,"sources":["/pages/content/news/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Panel from 'ts/ui/Panel.ts';\r\nimport Table from 'ts/ui/Table.ts';\r\nimport {Combo} from 'ts/ui/Combo';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport {store} from '../../../ts/util/store';\r\nimport {url} from '../../../ts/util/utils';\r\nimport {Cache} from 'ts/util/store';\r\n\r\nlet cache = Cache.getInstance();\r\n\r\nconsole.log('Languages:', Languages);\r\n\r\nconst infoPage = __uri('/pages/content/news/add.html');\r\n\r\nopg.api({\r\n\t'list!post': 'Information/QueryInformations',\r\n\tsetStick: 'Information/SetInformationStick',\r\n\tcancelStick: 'Information/CancelInformationStick',\r\n\t'setStatus!post': 'Information/EnableOrDisableInformationById',\r\n});\r\n\r\nconst lpg = Languages.package;\r\n\r\nconst moduleName = lpg.news;\r\n\r\nlet panel: Panel = opg.wrapPanel('#tbSearch', {\r\n\ttitle: `${moduleName}${lpg.search}`,\r\n\tbtnSearchText: `<i class=\"ico-find\"></i> ${lpg.search}`,\r\n\tbtnSearchClick: function () {\r\n\t\tlet param = $('#tbSearch').fieldsToJson();\r\n\r\n\t\tif (param.beginDate && param.beginDate.indexOf(' ') < 0) {\r\n\t\t\tparam.beginDate += ' 00:00:00';\r\n\t\t}\r\n\t\tif (param.endDate && param.endDate.indexOf(' ') < 0) {\r\n\t\t\tparam.endDate += ' 23:59:59';\r\n\t\t}\r\n\t\t//console.log(panel.jq, param);\r\n\t\ttb.update(param);\r\n\t},\r\n});\r\n\r\n\r\njQuery.datetimepicker.setLocale(Languages.current);\r\nCombo.makeClearableInput($('#beginDate').datetimepicker({\r\n\ttimepicker: false,\r\n\tcloseOnDateSelect: true,\r\n\tformat: 'Y-m-d',\r\n}), $({}));\r\nCombo.makeClearableInput($('#endDate').datetimepicker({\r\n\ttimepicker: false,\r\n\tcloseOnDateSelect: true,\r\n\tformat: 'Y-m-d',\r\n}), $({}));\r\n\r\n\r\nconst permission = store.get('permission');\r\nlet tbButtons = [];\r\nif (permission) {\r\n\tif (permission['NewsManagement']) {\r\n\t\ttbButtons.push({id: 'btnAdd', className: 'btn-create', html: `<i class=\"ico ico-create\"></i> ${lpg.add}`});\r\n\t}\r\n}\r\n\r\n\r\nlet tb: Table = opg('#tb').table({\r\n\tapi: opg.api.list,\r\n\tparam: {informationType: 0},\r\n\tfixFooter: true,\r\n\ttitleBar: {\r\n\t\ttitle: `${moduleName}${lpg.list}`,\r\n\t\tbuttons: tbButtons,\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: 'ID',\r\n\t\t\tsrc: 'id',\r\n\t\t\twidth:50\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.newsTitle}`,\r\n\t\t\tsrc: 'title',\r\n            width: 350\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.publisher,\r\n\t\t\tsrc: 'from',\r\n\t\t\twidth: 150\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.stick,\r\n\t\t\tsrc: 'stick',\r\n\t\t\twidth: 60,\r\n\t\t\trender: v => v ? lpg.yes : lpg.no,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.status,\r\n\t\t\tsrc: 'status',\r\n\t\t\twidth: 100,\r\n\t\t\trender: v => v ? lpg.online : lpg.offline,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.process,\r\n\t\t\tsrc: 'id',\r\n\t\t\twidth: 180,\r\n\t\t\talign: 'left',\r\n\t\t\trender: function (id, index, row) {\r\n\t\t\t\tlet html = `<button data-id=\"${id}\" data-index=\"${row[':index']}\" class=\"btn-mini btn-info btnEdit\">${lpg.edit}</button> `;\r\n\r\n\t\t\t\tif (!row.stick) {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-success btnSetStick\">${lpg.stick}</button> `;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-warning btnCancelStick\">${lpg.cancelStick}</button> `;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (row.status) {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-danger btnOffline\">${lpg.offline}</button>`;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-success btnOnline\">${lpg.online}</button>`;\r\n\t\t\t\t}\r\n\t\t\t\treturn html;\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n\tpagination: true,\r\n});\r\n\r\n\r\n//edit\r\ntb.tbody.on('click', '.btnEdit', function () {\r\n\tlet btn = $(this), id = btn.data('id'), index = btn.data('index');\r\n\r\n\tlet row = tb.data[index];\r\n\trow.enableStick = row.stick ? 1 : 0;\r\n\r\n\tcache.set('row', row);\r\n\r\n\tlet src = url.setParam(infoPage, {id});\r\n\r\n\tlet pop = opg.popTop(`<iframe src=\"${src}\" />`, {\r\n\t\ttitle: `${lpg.edit}: ${row.title}`,\r\n\t\tbtnMax: true,\r\n\t\twidth: 800,\r\n\t\theight: 550,\r\n\t\tonClose: function () {\r\n\t\t\tcache.remove('row');\r\n\t\t\ttb.update();\r\n\t\t},\r\n\t});\r\n});\r\n//offline\r\ntb.tbody.on('click', '.btnOffline', function () {\r\n\tlet btn = $(this), id = btn.data('id');\r\n\topg.api.setStatus({id, status: 0}, () => tb.update());\r\n});\r\n//online\r\ntb.tbody.on('click', '.btnOnline', function () {\r\n\tlet btn = $(this), id = btn.data('id');\r\n\topg.api.setStatus({id, status: 1}, () => tb.update());\r\n});\r\n\r\n\r\n//stick\r\ntb.tbody.on('click', '.btnSetStick', function () {\r\n\tlet btn = $(this), informationId = btn.data('id');\r\n\topg.api.setStick({informationId}, () => tb.update());\r\n});\r\n//stick\r\ntb.tbody.on('click', '.btnCancelStick', function () {\r\n\tlet btn = $(this), informationId = btn.data('id');\r\n\topg.api.cancelStick({informationId}, () => tb.update());\r\n});\r\n\r\n\r\n//Add\r\n$('#btnAdd').click(function () {\r\n\r\n\tlet pop = opg.popTop(`<iframe src=\"${infoPage}\" />`, {\r\n\t\ttitle: `${lpg.add}${moduleName}`,\r\n\t\tbtnMax: true,\r\n\t\twidth: 800,\r\n\t\theight: 400,\r\n\t\tonClose: function () {\r\n\t\t\ttb.update();\r\n\t\t},\r\n\t});\r\n});"]}
{"version":3,"sources":["/pages/content/exhibition/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport {url} from 'ts/util/utils';\r\nimport {store} from 'ts/util/store';\r\nimport Panel from 'ts/ui/Panel';\r\nimport {Combo} from 'ts/ui/Combo';\r\nimport {Cache} from 'ts/util/store';\r\n\r\nconst categoryType = 1;//0为媒体...1为展会信息\r\n\r\nlet cache = Cache.getInstance();\r\n\r\n\r\nopg.api({\r\n\tgetTypes: 'meinfotype/GetMediaExhibtionInfoType?type=' + categoryType,\r\n\t'addType!POST': 'meinfotype/AddMediaExhibitionInfoType',\r\n\t'editType!POST': 'meinfotype/UpMediaExhibitionInfoType',\r\n\tdelType: 'meinfotype/DelMediaExhibitionInfoType',\r\n\t'getMedia!POST': 'mediaexhibtion/QueryMediaExhibitionInfos',\r\n\t'delPhotosByIds!POST': 'photo/DelPhotosByIds',\r\n\tsetStick: 'mediaexhibtion/SetMediaExhibitionInfoStick',\r\n\tcancelStick: 'mediaexhibtion/CancelMediaExhibitionInfoStick',\r\n\t'setStatus!post': 'mediaexhibtion/EnableOrDisableMediaExhibitionInfoById',\r\n});\r\nconst lpg = Languages.package;\r\nconst permission = store.get('permission') || '';\r\n\r\nlet categoryData = [] ;\r\nfunction setCategoryData(){\r\n\t/*categoryData = {};\r\n\tlet arr = <Array> tree.data;\r\n\tarr.forEach((v)=>{\r\n\t\tcategoryData[v.id] = v.name;\r\n\t});*/\r\n\r\n\tcategoryData = tree.data;\r\n\tcategoryData.splice(0, 0 , {id:0 , name: lpg.root});\r\n\tcache.set('categoryData' , categoryData);\r\n\tconsole.log('categoryData' , categoryData);\r\n}\r\n\r\nlet treeName = 'mediaTypes';\r\nlet tree = opg('#tree').tree({\r\n\tapi: opg.api.getTypes,\r\n\tname: treeName,\r\n\troot: `<label><input type=\"radio\" name=\"tree_${treeName}Rd\" value=\"0\" checked> ${lpg.root}</label>`,\r\n\tcmd: 'checkOne',\r\n\tchildSrc: 'childPhotoTypes',\r\n\tonCreate: setCategoryData,\r\n\tonUpdate: setCategoryData,\r\n});\r\ntree.jq.on('change', ':radio', function () {\r\n\tlet elem = $(this), id = elem.val(), deal = elem.prop('checked');\r\n\tlet name = elem.closest('label').text();\r\n\t//console.warn(elem.parent() , elem.parent().text() , name);\r\n\tif (deal) {\r\n\t\tcurrentCategoryId = id;\r\n\t\tcurrentCategoryName = name.trim();\r\n\t\ttb.update({mediaExhibtionInfoTypeId: id});\r\n\t\t(document.getElementById('form1') as HTMLFormElement).reset();\r\n\t}\r\n});\r\n\r\n\r\nlet currentCategoryId = 0;\r\nlet currentCategoryName = lpg.root;\r\n\r\n\r\nlet panel: Panel = opg.wrapPanel('#form1', {\r\n\ttitle: `${lpg.current}${lpg.exhibitionCategory}${lpg.search}`,\r\n\tbtnSearchText: `<i class=\"ico-find\"></i> ${lpg.search}`,\r\n\tbtnSearchClick: function () {\r\n\t\tlet param = $('#tbSearch').fieldsToJson();\r\n\r\n\t\tif (param.beginDate && param.beginDate.indexOf(' ') < 0) {\r\n\t\t\tparam.beginDate += ' 00:00:00';\r\n\t\t}\r\n\t\tif (param.endDate && param.endDate.indexOf(' ') < 0) {\r\n\t\t\tparam.endDate += ' 23:59:59';\r\n\t\t}\r\n\t\t//console.log(panel.jq, param);\r\n\t\ttb.update(param);\r\n\t},\r\n});\r\njQuery.datetimepicker.setLocale(Languages.current);\r\nCombo.makeClearableInput($('#beginDate').datetimepicker({\r\n\ttimepicker: false,\r\n\tcloseOnDateSelect: true,\r\n\tformat: 'Y-m-d',\r\n}), $({}));\r\nCombo.makeClearableInput($('#endDate').datetimepicker({\r\n\ttimepicker: false,\r\n\tcloseOnDateSelect: true,\r\n\tformat: 'Y-m-d',\r\n}), $({}));\r\n\r\n\r\nlet tbButtons = [];\r\nif (permission) {\r\n\tif (permission['AddExhibitionInfo']) {\r\n\t\ttbButtons.push({id: 'btnAdd', className: 'btn-create', html: `<i class=\"ico ico-create\"></i> ${lpg.add}`});\r\n\t}\r\n}\r\n\r\nlet tb = opg('#tb').table({\r\n\tapi: opg.api.getMedia,\r\n\tparam: {\r\n\t\tinformationType: categoryType,\r\n\t\tmediaExhibtionInfoTypeId: currentCategoryId,\r\n\t},\r\n\ttitleBar: {\r\n\t\ttitle: `${lpg.exhibitionUnderCurrentCategory}`,\r\n\t\tbuttons: tbButtons,\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: 'ID', width: 120,\r\n\t\t\tsrc: 'id',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.exhibitionTitle,\r\n\t\t\tsrc: 'title',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.publisher,\r\n\t\t\tsrc: 'from',\r\n\t\t\twidth: 150,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.stick,\r\n\t\t\tsrc: 'stick',\r\n\t\t\twidth: 60,\r\n\t\t\trender: v => v ? lpg.yes : lpg.no,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.status,\r\n\t\t\tsrc: 'status',\r\n\t\t\twidth: 100,\r\n\t\t\trender: v => v ? lpg.online : lpg.offline,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: lpg.process,\r\n\t\t\tsrc: 'id',\r\n\t\t\twidth: 180,\r\n\t\t\talign: 'left' ,\r\n\t\t\trender: function (id, index, row) {\r\n\t\t\t\tlet html = `<button data-id=\"${id}\" data-index=\"${row[':index']}\" class=\"btn-mini btn-info btnEdit\">${lpg.edit}</button> `;\r\n\t\t\t\tif (!row.stick) {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-success btnSetStick\">${lpg.stick}</button> `;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-warning btnCancelStick\">${lpg.cancelStick}</button> `;\r\n\t\t\t\t}\r\n\t\t\t\tif (row.status) {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-danger btnOffline\">${lpg.offline}</button>`;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\thtml += `<button data-id=\"${id}\" class=\"btn-mini btn-success btnOnline\">${lpg.online}</button>`;\r\n\t\t\t\t}\r\n\t\t\t\treturn html;\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n\tpagination: true,\r\n});\r\n\r\n\r\nif (permission.ExhibitionInfoType) {\r\n\t$('#pButton').show();\r\n\r\n\t// add category\r\n\t$('#btnAddType').click(function () {\r\n\r\n\t\tlet checkedRadio = tree.jq.find(':radio:checked');\r\n\t\tlet sp = checkedRadio.closest('span');\r\n\t\tif (~~sp.data('depth') === 1) {\r\n\t\t\treturn top.opg.warn(lpg.addCategoryWarn);\r\n\t\t}\r\n\r\n\t\tlet nameInput = $('<input type=\"text\" name=\"name\">');\r\n\t\tlet pop = top.opg.confirm($(`<div style=\"padding: 20px;\">${lpg.categoryName}: </div>`).append(nameInput), function () {\r\n\t\t\tlet name = nameInput.val();\r\n\t\t\tif (name) {\r\n\t\t\t\topg.api.addType({type: categoryType, name}, () => {\r\n\t\t\t\t\ttree.update();\r\n\t\t\t\t\tpop.close();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}, {\r\n\t\t\ttitle: lpg.addCategory,\r\n\t\t\twidth: 500,\r\n\t\t\theight: 200,\r\n\t\t});\r\n\t});\r\n\r\n\r\n\t// edit category\r\n\t$('#btnEdit').click(function () {\r\n\r\n\t\tlet checkedRadio = tree.jq.find(':radio:checked');\r\n\t\tlet id = ~~checkedRadio.val();\r\n\t\tif (!id) {\r\n\t\t\treturn top.opg.warn(lpg.editCategoryWarn);\r\n\t\t}\r\n\t\tlet lb = checkedRadio.closest('label');\r\n\r\n\t\tlet nameInput = $(`<input type=\"text\" name=\"name\" value=\"${lb.text()}\">`);\r\n\t\tlet pop = top.opg.confirm($(`<div style=\"padding: 20px;\">${lpg.categoryName}: </div>`).append(nameInput), function () {\r\n\t\t\tlet name = nameInput.val();\r\n\t\t\tif (name) {\r\n\t\t\t\topg.api.editType({type: categoryType, name, id}, function () {\r\n\t\t\t\t\ttree.update();\r\n\t\t\t\t\tpop.close();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}, {\r\n\t\t\ttitle: lpg.editCategory,\r\n\t\t\twidth: 500,\r\n\t\t\theight: 200,\r\n\t\t});\r\n\t});\r\n\r\n\t// delete category\r\n\t$('#btnDelType').click(function () {\r\n\r\n\t\tlet pop = top.opg.confirm(lpg.deleteCategoryWarn, function () {\r\n\t\t\tlet id = $(`:radio[name=tree_${treeName}Rd]:checked`).val();\r\n\t\t\topg.api.delType({id}, function () {\r\n\t\t\t\ttree.update();\r\n\t\t\t\tpop.close();\r\n\t\t\t});\r\n\t\t}, {});\r\n\r\n\t});\r\n\r\n}\r\n\r\n\r\n//\r\nif (permission.AddExhibitionInfo) {\r\n\r\n\tconst infoPage = __uri('/pages/content/exhibition/add.html');\r\n\r\n\t$('#btnAdd').click(function () {\r\n\r\n\t\tlet src = url.setParam(infoPage, {categoryId: currentCategoryId});\r\n\r\n\t\tlet pop = opg.popTop(`<iframe src=\"${src}\" />`, {\r\n\t\t\ttitle: `${lpg.add}`,\r\n\t\t\tbtnMax: true,\r\n\t\t\twidth: 800,\r\n\t\t\theight: 550,\r\n\t\t\tonClose: function () {\r\n\t\t\t\ttb.update(currentCategoryId);\r\n\t\t\t},\r\n\t\t});\r\n\t});\r\n\r\n\t//edit item\r\n\ttb.tbody.on('click', '.btnEdit', function () {\r\n\t\tlet btn = $(this), id = btn.data('id') , index = btn.data('index');\r\n\r\n\t\tlet row = tb.data[index];\r\n\t\trow.enableStick = row.stick?1:0;\r\n\t\trow.mediaTypeName = categoryType['mediaexhibitiontype_id'];\r\n\r\n\t\tcache.set('row' , row);\r\n\r\n\t\tlet src = url.setParam(infoPage, {categoryId: currentCategoryId , id});\r\n\r\n\t\tlet pop = opg.popTop(`<iframe src=\"${src}\" />`, {\r\n\t\t\ttitle: `${lpg.edit}: ${row.title}`,\r\n\t\t\tbtnMax: true,\r\n\t\t\twidth: 800,\r\n\t\t\theight: 550,\r\n\t\t\tonClose: function () {\r\n\t\t\t\tcache.remove('row');\r\n\t\t\t\ttb.update(currentCategoryId);\r\n\t\t\t},\r\n\t\t});\r\n\t});\r\n\r\n\t//offline\r\n\ttb.tbody.on('click', '.btnOffline', function () {\r\n\t\tlet btn = $(this), id = btn.data('id');\r\n\t\topg.api.setStatus({id, status: 0}, () => tb.update());\r\n\t});\r\n\t//online\r\n\ttb.tbody.on('click', '.btnOnline', function () {\r\n\t\tlet btn = $(this), id = btn.data('id');\r\n\t\topg.api.setStatus({id, status: 1}, () => tb.update());\r\n\t});\r\n\r\n\r\n\t//stick\r\n\ttb.tbody.on('click', '.btnSetStick', function () {\r\n\t\tlet btn = $(this), informationId = btn.data('id');\r\n\t\topg.api.setStick({informationId}, () => tb.update());\r\n\t});\r\n\t//stick\r\n\ttb.tbody.on('click', '.btnCancelStick', function () {\r\n\t\tlet btn = $(this), informationId = btn.data('id');\r\n\t\topg.api.cancelStick({informationId}, () => tb.update());\r\n\t});\r\n}\r\n"]}
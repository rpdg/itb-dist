{"version":3,"sources":["/pages/content/notice/addSubject.ts"],"names":[],"mappings":"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","file":"addSubject.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport PopUp from 'ts/ui/Popup';\r\nimport {Languages} from 'ts/util/Languages';\r\n\r\nconst lpg = Languages.package;\r\nconsole.log('Languages:', Languages);\r\n\r\nopg.api({\r\n\tgetSubject: 'Information/GetInformationSubContentById',\r\n\t'addSubject!post': 'Information/AddInformationSubContent',\r\n\t'updateSubject!post': 'Information/UpInformationSubContent',\r\n\t'upload!UPLOAD': 'upload/files',\r\n});\r\n\r\nconst informationId = opg.request['id'];\r\nconst subjectId = opg.request['subId'];\r\n\r\nlet imgUrl;\r\n\r\nlet format = {\r\n\t0: lpg.pureText,\r\n\t1: lpg.picture,\r\n\t2: lpg.link,\r\n\t3: lpg.richText,\r\n};\r\nlet formatType;\r\n\r\n\r\nlet panel = $('#panel');\r\n\r\nlet selType = $('#selType').on('change', function () {\r\n\r\n\r\n\tformatType = ~~selType.val();\r\n\tswitch (formatType) {\r\n\t\tcase 0:\r\n\t\t\tpanel.html(`<textarea style=\"width: 460px; height: 230px;\"></textarea>`);\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\tpanel.html(`<form>\r\n\t\t\t\t\t\t<input name=\"text\" type=\"text\" placeholder=\"${lpg.linkText}\" style=\"width: 100%;\"/>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<input name=\"url\" type=\"text\" placeholder=\"${lpg.linkHref}\" style=\"width: 100%;margin-top: 0.5em;\"/>\r\n\t\t\t\t</form>`);\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tpanel.empty();\r\n\t}\r\n});\r\n\r\n\r\nif (subjectId) {\r\n\topg.api.getSubject({id : subjectId} , (data)=>{\r\n\t\t//debugger;\r\n\t\t$('#lbFormatType').jsonToFields(data[0]);\r\n\t\tselType.trigger('change').prop('disabled' , true);\r\n\t\tformatType = ~~selType.val();\r\n\t\tif(formatType==0){\r\n\t\t\tpanel.find('textarea').text(data[0].content);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\nwindow['doSave'] = function (pop: PopUp, listSubjects: Function) {\r\n\tlet content;\r\n\tswitch (formatType) {\r\n\t\tcase 0 :\r\n\t\t\tcontent = panel.find('textarea').eq(0).val();\r\n\t\t\tbreak;\r\n\t\tcase 1 :\r\n\t\t\tcontent = imgUrl;\r\n\t\t\tbreak;\r\n\t\tcase 2 :\r\n\t\t\tlet txt, url;\r\n\t\t\tpanel.find('input').each((i, ele) => {\r\n\t\t\t\tlet val = (ele as HTMLInputElement).value;\r\n\t\t\t\tif (!val) {\r\n\t\t\t\t\treturn opg.warn(lpg.nullInputWarn);\r\n\t\t\t\t}\r\n\t\t\t\tif (i === 0)\r\n\t\t\t\t\ttxt = val;\r\n\t\t\t\telse\r\n\t\t\t\t\turl = val;\r\n\t\t\t});\r\n\t\t\tcontent = `<a href=\"${url}\">${txt}</a>`;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\topg.warn(lpg.plsSelect);\r\n\t\t\treturn;\r\n\t}\r\n\r\n\tif (!content) {\r\n\t\topg.warn(lpg.nullInputWarn);\r\n\t}\r\n\telse {\r\n\t\tif (subjectId) {\r\n\t\t\topg.api.updateSubject({content: content, id: subjectId}, data => {\r\n\t\t\t\tlistSubjects();\r\n\t\t\t\tpop.close();\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\topg.api.addSubject({formatType, informationId, content}, function (data) {\r\n\t\t\t\tlistSubjects();\r\n\t\t\t\tpop.close();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n\r\n};"]}
{"version":3,"sources":["/pages/content/photo/add.ts"],"names":[],"mappings":";;;;AAAA,oCAA4B;AAE5B,+CAA4C;AAE5C,IAAM,GAAG,GAAG,qBAAS,CAAC,OAAO,CAAC;AAC9B,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,qBAAS,CAAC,CAAC;AAQrC,gBAAG,CAAC,GAAG,CAAC;IACP,eAAe,EAAE,cAAc;IAC/B,gBAAgB,EAAE,iBAAiB;CACnC,CAAC,CAAC;AAEH,IAAM,MAAM,GAAW,CAAC,CAAC,gBAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC/C,IAAI,MAAM,GAAY,EAAE,CAAC;AACzB,IAAI,OAAO,GAAwC,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;AACpF,CAAC,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC;IACrB,IAAI,KAAK,GAAa,OAAO,CAAC,KAAK,CAAC;IACpC,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QACtB,IAAI,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAC9B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACvC,QAAQ,CAAC,MAAM,CAAC,OAAO,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACxC,CAAC;QACD,gBAAG,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE,UAAU,IAAI;YACtC,OAAO,CAAC,KAAK,GAAG,EAAE,CAAC;YAEnB,CAAC,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC;gBACpB,IAAI,EAAE,IAAI;gBACV,QAAQ,EAAE,6BAA6B;gBACvC,IAAI,EAAE,QAAQ;aACd,CAAC,CAAC;YAEH,IAAI,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,CAAC;gBACf,MAAM,CAAC,IAAI,CAAC;oBACX,MAAM;oBACN,GAAG,EAAE,GAAG,CAAC,YAAY;iBACrB,CAAC,CAAC;YACJ,CAAC,CAAC;QACH,CAAC,CAAC,CAAC;IACJ,CAAC;AACF,CAAC,CAAC,CAAC;AAGH,MAAM,CAAC,MAAM,CAAC,GAAG,UAAU,GAAU;IACpC,IAAI,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC;IAC5B,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACT,MAAM,CAAC,OAAO,CAAC,aAAG;YACjB,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC;QACjB,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,gBAAG,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,EAAE;QACzB,GAAG,CAAC,KAAK,EAAE,CAAC;IACb,CAAC,CAAC;AACH,CAAC,CAAC","file":"add.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport PopUp from 'ts/ui/Popup';\r\nimport {Languages} from 'ts/util/Languages';\r\n\r\nconst lpg = Languages.package;\r\nconsole.log('Languages:', Languages);\r\n\r\ninterface Photo {\r\n\ttitle?: string;\r\n\ttypeId: number;\r\n\turl: string;\r\n}\r\n\r\nopg.api({\r\n\t'upload!UPLOAD': 'upload/files',\r\n\t'addPhotos!post': 'photo/AddPhotos',\r\n});\r\n\r\nconst typeId: number = ~~opg.request['typeId'];\r\nlet imgArr: Photo[] = [];\r\nlet fileIpt: HTMLInputElement = <HTMLInputElement> document.getElementById('files');\r\n$('#btnUpload').click(function () {\r\n\tlet files: FileList = fileIpt.files;\r\n\tif (files.length > 0) {\r\n\t\tlet formData = new FormData();\r\n\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\tformData.append(\"file_\" + i, files[i]);\r\n\t\t}\r\n\t\topg.api.upload(formData, function (data) {\r\n\t\t\tfileIpt.value = '';\r\n\r\n\t\t\t$('#panel').bindList({\r\n\t\t\t\tlist: data,\r\n\t\t\t\ttemplate: '<img src=\"${downloadLink}\">',\r\n\t\t\t\tmode: 'append'\r\n\t\t\t});\r\n\r\n\t\t\tdata.map((val, i) => {\r\n\t\t\t\timgArr.push({\r\n\t\t\t\t\ttypeId,\r\n\t\t\t\t\turl: val.downloadLink\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n});\r\n\r\n\r\nwindow['save'] = function (pop: PopUp) {\r\n\tlet tag = $('#title').val();\r\n\tif (tag) {\r\n\t\timgArr.forEach(img => {\r\n\t\t\timg.title = tag;\r\n\t\t});\r\n\t}\r\n\r\n\topg.api.addPhotos(imgArr, () => {\r\n\t\tpop.close();\r\n\t})\r\n};"]}
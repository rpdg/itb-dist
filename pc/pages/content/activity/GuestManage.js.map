{"version":3,"sources":["/pages/content/activity/GuestManage.ts"],"names":[],"mappings":"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","file":"GuestManage.js","sourcesContent":["import opg from 'ts/opg';\r\nimport Table from 'ts/ui/Table';\r\nimport Popup from 'ts/ui/Popup';\r\n\r\nimport {Languages} from 'ts/util/Languages';\r\n\r\nconst lng = Languages.package;\r\n\r\n\r\nconst guestForm = $(`<form class=\"guestForm\">\r\n\t<label>${lng.guestName}: <input type=\"text\" name=\"name\"></label><br>\r\n\t<label>${lng.guestTitle}: <input type=\"text\" name=\"title\"></label><br>\r\n\t<label>${lng.guestBrief}: <input type=\"text\" name=\"intro\"></label>\r\n</form>`);\r\n\r\nexport default class GuestManage {\r\n\r\n\tprivate tb: Table;\r\n\tprivate activityId: number;\r\n\r\n\tconstructor(subjectId: number) {\r\n\r\n\r\n\t\topg.api({\r\n\t\t\tgetGuest: 'activity/GetActivityHonoredGuestByActivityContnetId?activityContentId=' + subjectId,\r\n\t\t\t'addGuest!post': 'activity/AddActivityHonoredGuest',\r\n\t\t\t'delGuest!post': 'activity/DelActivityHonoredGuest',\r\n\t\t});\r\n\r\n\t\tthis.activityId = subjectId;\r\n\r\n\r\n\t\tlet $tb = $('<table></table>');\r\n\r\n\t\t$tb.appendTo('body');\r\n\t\tthis.tb = opg($tb).table({\r\n\t\t\tapi: opg.api.getGuest,\r\n\t\t\ttitleBar: {\r\n\t\t\t\ttitle: lng.guest,\r\n\t\t\t\tbuttons: [\r\n\t\t\t\t\t{id: 'btnAddGuest', className: 'btn-create', html: `<i class=\"ico ico-create\"></i> ${lng.add}`},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tcolumns: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: lng.guestName, width: 200,\r\n\t\t\t\t\tsrc: 'name',\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: lng.guestTitle, width: 200,\r\n\t\t\t\t\tsrc: 'title',\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: lng.guestBrief,\r\n\t\t\t\t\tsrc: 'intro',\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: lng.process,\r\n\t\t\t\t\tsrc: 'id',\r\n\t\t\t\t\twidth: 100,\r\n\t\t\t\t\trender: id => `<button data-id=\"${id}\" class=\"btn-mini btn-danger btnDel\">${lng.del}</button>`,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t});\r\n\r\n\t\t//add\r\n\t\t$('#btnAddGuest').click(() => {\r\n\t\t\tthis.addGuest();\r\n\t\t});\r\n\r\n\t\t//delete\r\n\t\tthis.tb.tbody.on('click', '.btnDel', (e) => {\r\n\t\t\tlet btn = $(e.target), id = ~~btn.data('id');\r\n\t\t\tthis.deleteGuest(id);\r\n\t\t});\r\n\t}\r\n\r\n\taddGuest() {\r\n\t\tlet that = this;\r\n\t\tlet pop: Popup = opg.confirm(guestForm, function () {\r\n\t\t\tlet param = guestForm.fieldsToJson({\r\n\t\t\t\tname: {\r\n\t\t\t\t\trequire: true,\r\n\t\t\t\t\ttype: 'ns',\r\n\t\t\t\t\tname: lng.guestName,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\tif (param) {\r\n\t\t\t\tparam.activityContentId = that.activityId;\r\n\t\t\t\topg.api.addGuest(param, data => {\r\n\t\t\t\t\tthat.tb.update();\r\n\t\t\t\t\tpop.close();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tdeleteGuest(id: number) {\r\n\t\tlet that = this;\r\n\t\tlet pop: Popup = opg.confirm(lng.deleteGuestConfirm, function () {\r\n\r\n\t\t\topg.api.delGuest({activityContentId: that.activityId, userId: id}, data => {\r\n\t\t\t\tthat.tb.update();\r\n\t\t\t\tpop.close();\r\n\t\t\t});\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n}"]}
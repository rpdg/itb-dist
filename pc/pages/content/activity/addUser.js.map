{"version":3,"sources":["/pages/content/activity/addUser.ts"],"names":[],"mappings":";;;;AAAA,oCAA4B;AAE5B,+CAA4C;AAK5C,gBAAG,CAAC,GAAG,CAAC;IACP,UAAU,EAAE,iBAAiB;IAC7B,sBAAsB,EAAE,0CAA0C;IAClE,eAAe,EAAE,sCAAsC;CACvD,CAAC,CAAC;AAEH,IAAM,SAAS,GAAG,CAAC,CAAC,gBAAG,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;AAG7C,IAAM,GAAG,GAAG,qBAAS,CAAC,OAAO,CAAC;AAC9B,IAAM,UAAU,GAAG,GAAG,CAAC,OAAO,CAAC;AAE/B,IAAM,IAAI,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC;AAC5B,IAAI,KAAK,GAAU,gBAAG,CAAC,SAAS,CAAC,WAAW,EAAE;IAC7C,KAAK,EAAE,KAAG,UAAY;IACtB,aAAa,EAAE,gCAA4B,GAAG,CAAC,MAAQ;IACvD,cAAc,EAAE;QACf,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QAChC,KAAK,CAAC,SAAS,GAAG,CAAC,CAAC;QACpB,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACvB,CAAC;CACD,CAAC,CAAC;AAEH,IAAI,OAAO,GAAG,gBAAG,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC;IACpC,GAAG,EAAE,gBAAG,CAAC,GAAG,CAAC,UAAU;IACvB,gBAAgB,EAAE,KAAK;CACvB,CAAC,CAAC;AAEH,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC;IACnC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AAClC,CAAC,CAAC,CAAC;AAEH,IAAI,OAAO,GAAU,gBAAG,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;IACrC,GAAG,EAAE,gBAAG,CAAC,GAAG,CAAC,eAAe;IAC5B,IAAI,EAAE,IAAI;IACV,QAAQ,EAAE;QACT,KAAK,EAAE,KAAG,UAAU,GAAG,GAAG,CAAC,IAAM;KACjC;IACD,OAAO,EAAE;QACR;YACC,IAAI,EAAE,GAAG;YACT,GAAG,EAAE,UAAU;YACf,GAAG,EAAE,SAAS;SACd;QACD;YACC,IAAI,EAAE,KAAG,GAAG,CAAC,aAAe;YAC5B,GAAG,EAAE,UAAU;SACf;QACD;YACC,IAAI,EAAE,KAAG,GAAG,CAAC,QAAU;YACvB,GAAG,EAAE,WAAW;YAChB,MAAM,EAAE,UAAC,EAAE,EAAE,CAAC,EAAE,GAAG,IAAK,QAAG,EAAE,IAAI,EAAE,WAAI,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAE,EAAnC,CAAmC;SAC3D;QACD;YACC,IAAI,EAAE,KAAG,GAAG,CAAC,QAAU;YACvB,GAAG,EAAE,MAAM;SACX;KACD;IACD,UAAU,EAAE;QACX,QAAQ,EAAE,CAAC;QACX,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC;KACzB;CACD,CAAC,CAAC;AAGH,MAAM,CAAC,MAAM,CAAC,GAAG,UAAU,GAAU,EAAE,EAAS;IAC/C,IAAI,GAAG,GAAG,OAAO,CAAC,eAAe,EAAE,CAAC;IACpC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;QAChB,OAAO,gBAAG,CAAC,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;KACpC;IACD,IAAI,oBAAoB,GAAG,EAAE,CAAC;IAC9B,GAAG,CAAC,GAAG,CAAC,UAAC,GAAG;QACX,oBAAoB,CAAC,IAAI,CAAC;YACzB,QAAQ,EAAE,CAAC,CAAC,GAAG;YACf,cAAc,EAAE,CAAC;SACjB,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IACH,IAAI,KAAK,GAAG;QACX,EAAE,EAAE,SAAS;QACb,oBAAoB;KACpB,CAAC;IAEF,gBAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE;QACvB,EAAE,CAAC,MAAM,EAAE,CAAC;QACZ,cAAc;IACf,CAAC,CAAC,CAAC;AACJ,CAAC,CAAC","file":"addUser.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Table from 'ts/ui/Table.ts';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport Panel from 'ts/ui/Panel';\r\nimport PopUp from 'ts/ui/Popup';\r\n\r\n\r\nopg.api({\r\n\tgetAllRole: 'role/GetAllRole',\r\n\t'getRoleUserList!post': 'user/SearchUsersByRoleAndUserNameKeyword',\r\n\t'addUsers!post': 'activity/BatchAddActivityContentUser',\r\n});\r\n\r\nconst subjectId = ~~opg.request['subjectId'];\r\n\r\n\r\nconst lpg = Languages.package;\r\nconst moduleName = lpg.addUser;\r\n\r\nconst form = $('#tbSearch');\r\nlet panel: Panel = opg.wrapPanel('#tbSearch', {\r\n\ttitle: `${moduleName}`,\r\n\tbtnSearchText: `<i class=\"ico-find\"></i> ${lpg.search}`,\r\n\tbtnSearchClick: function () {\r\n\t\tlet param = form.fieldsToJson();\r\n\t\tparam.pageIndex = 0;\r\n\t\ttbUsers.update(param);\r\n\t},\r\n});\r\n\r\nlet selRole = opg('#roleId').listBox({\r\n\tapi: opg.api.getAllRole,\r\n\tautoPrependBlank: false,\r\n});\r\n\r\n$.when(selRole.createdPromise).then(function () {\r\n\tpanel.btnSearch.trigger('click');\r\n});\r\n\r\nlet tbUsers: Table = opg('#tb').table({\r\n\tapi: opg.api.getRoleUserList,\r\n\tlazy: true,\r\n\ttitleBar: {\r\n\t\ttitle: `${moduleName}${lpg.list}`,\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: ' ',\r\n\t\t\tcmd: 'checkAll',\r\n\t\t\tsrc: 'user_id',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.userLoginName}`,\r\n\t\t\tsrc: 'username',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.realName}`,\r\n\t\t\tsrc: 'firstname',\r\n\t\t\trender: (fn, i, row) => `${fn || ''} ${row.lastname || ''}`,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.roleName}`,\r\n\t\t\tsrc: 'name',\r\n\t\t},\r\n\t],\r\n\tpagination: {\r\n\t\tpageSize: 5,\r\n\t\tcustomizable: [5, 10, 20],\r\n\t},\r\n});\r\n\r\n\r\nwindow['save'] = function (pop: PopUp, tb: Table) {\r\n\tlet ids = tbUsers.getCheckedValue();\r\n\tif (!ids.length) {\r\n\t\treturn opg.warn(lpg.nullSelectWarn);\r\n\t}\r\n\tlet activityContentUsers = [];\r\n\tids.map((val) => {\r\n\t\tactivityContentUsers.push({\r\n\t\t\t'userId': ~~val,\r\n\t\t\t'isSendInvite': 0,\r\n\t\t});\r\n\t});\r\n\tlet param = {\r\n\t\tid: subjectId,\r\n\t\tactivityContentUsers,\r\n\t};\r\n\r\n\topg.api.addUsers(param, () => {\r\n\t\ttb.update();\r\n\t\t//pop.close();\r\n\t});\r\n};\r\n\r\n"]}
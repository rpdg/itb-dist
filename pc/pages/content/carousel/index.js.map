{"version":3,"sources":["/pages/content/carousel/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import opg from 'ts/opg.ts';\r\nimport Table from 'ts/ui/Table.ts';\r\nimport {Languages} from 'ts/util/Languages';\r\nimport {store} from 'ts/util/store';\r\n\r\nconsole.log('Languages:', Languages);\r\n\r\nopg.api({\r\n\tgetAll: 'canrousel/GetAllCanrouselNotLimit',\r\n\tgetCount: 'canrousel/GetCurCanrouselCount',\r\n\tsetCount: 'canrousel/SetCurCanrouselCount',\r\n\tdelete: 'canrousel/DelCanrouselById',\r\n\t'position!post': 'canrousel/ChangeCanrouselPosition',\r\n});\r\n\r\nconst lpg = Languages.package;\r\nconst moduleName = lpg.carousel;\r\nconst permission = store.get('permission');\r\nconsole.log('Permission:', permission);\r\n\r\n\r\nlet tbButtons = [];\r\nif (permission) {\r\n\tif (permission['AddCarousel']) {\r\n\t\ttbButtons.push({id: 'btnAdd', className: 'btn-create', html: `<i class=\"ico ico-create\"></i> ${lpg.add}`});\r\n\t}\r\n\tif (permission['CarouselSeeting']) {\r\n\t\ttbButtons.push({id: 'btnSet', className: 'btn-warning', html: `<i class=\"ico ico-edit\"></i> ${lpg.set}`});\r\n\t}\r\n}\r\n\r\n\r\nlet informationType = {\r\n\t0: 'news',\r\n\t1: 'announcement',\r\n\t2: 'sponsor',\r\n};\r\nlet tb: Table = opg('#tb').table({\r\n\tapi: opg.api.getAll,\r\n\ttitleBar: {\r\n\t\ttitle: `${moduleName}${lpg.list}`,\r\n\t\tbuttons: tbButtons,\r\n\t},\r\n\tcolumns: [\r\n\t\t{\r\n\t\t\ttext: `${lpg.serial}`, width: 120,\r\n\t\t\tsrc: 'cid',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.newsTitle}`,\r\n\t\t\tsrc: 'title',\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.linkType}`,\r\n\t\t\tsrc: 'informationtype',\r\n\t\t\twidth: 150,\r\n\t\t\trender: v => lpg[informationType[v]],\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.showIndex}`,\r\n\t\t\tsrc: 'cposition',\r\n\t\t\twidth: 90,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.linkBinding}`,\r\n\t\t\tsrc: 'informationtype',\r\n\t\t\twidth: 120,\r\n\t\t\trender: (v, i, row) => `${lpg[informationType[v]]}: ${row.id}`,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttext: `${lpg.process}`,\r\n\t\t\tsrc: 'cid',\r\n\t\t\twidth: 200,\r\n\t\t\trender: function (val, i, row, keyName, arr) {\r\n\t\t\t\t//console.log(arr);\r\n\t\t\t\treturn `\r\n\t\t\t\t\t\t<button class=\"btn-mini btn-info\" data-id=\"${val}\" data-index=\"${row[':index']}\" \r\n\t\t\t\t\t\t        data-previd=\"${i > 0 ? arr[i - 1].cid : ''}\"\r\n\t\t\t\t\t\t        data-nextid=\"${i < arr.length -1 ? arr[i + 1].cid : ''}\"\r\n\t\t\t\t\t\t\t\tdata-action=\"-1\" ${row[':index'] === 0 ? 'disabled' : ''}>${lpg.up}</button> \r\n\t\t\t\t\t\t<button class=\"btn-mini btn-info\" data-id=\"${val}\" data-index=\"${row[':index']}\" \r\n\t\t\t\t\t\t        data-previd=\"${i > 0 ? arr[i - 1].cid : ''}\"\r\n\t\t\t\t\t\t        data-nextid=\"${i < arr.length -1 ? arr[i + 1].cid : ''}\"\r\n\t\t\t\t\t\t\t\tdata-action=\"1\" ${row[':rowNum'] === arr.length ? 'disabled' : ''}>${lpg.down}</button> \r\n\t\t\t\t\t\t<button class=\"btn-mini btn-danger\" data-id=\"${val}\">${lpg.del}</button>\r\n\t\t\t\t`;\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n\tpagination: false,\r\n});\r\n\r\n\r\n//up/down\r\ntb.tbody.on('click', '.btn-info', function () {\r\n\tlet btn = $(this),  id = btn.data('id') , action = ~~btn.data('action') , swapId ;\r\n\tlet json = [];\r\n\tif(action===-1){\r\n\t\tswapId = btn.data('previd');\r\n\t\tjson.push({id: id});\r\n\t\tjson.push({id: swapId});\r\n\t}\r\n\telse{\r\n\t\tswapId = btn.data('nextid');\r\n\t\tjson.push({id: swapId});\r\n\t\tjson.push({id: id});\r\n\t}\r\n\r\n\t//console.log(json);\r\n\topg.api.position(json, () => tb.update());\r\n});\r\n\r\n//del\r\ntb.tbody.on('click', '.btn-danger', function () {\r\n\tlet btn = $(this), canrouselId = btn.data('id');\r\n\r\n\topg.danger(`${lpg.del}${lpg.carousel} [<b>${canrouselId}</b>] ? `, function () {\r\n\t\topg.api.delete({canrouselId}, () => tb.update());\r\n\t}, {\r\n\t\ttitle: `${lpg.please}${lpg.confirm}`,\r\n\t});\r\n});\r\n\r\n\r\nlet count = 0;\r\nopg.api.getCount(data => {\r\n\tcount = ~~data;\r\n});\r\n\r\n\r\n//set\r\n$('#btnSet').click(function () {\r\n\tlet $elem = $(`<input type=\"number\" style=\"width: 100%;\" value=\"${count}\">`);\r\n\tlet pop = top.opg.confirm($elem, function (i, ifr) {\r\n\t\tlet c = ~~$elem.val();\r\n\t\tif (c && c != count) {\r\n\t\t\topg.api.setCount({count: c}, () => {\r\n\t\t\t\tcount = c;\r\n\t\t\t});\r\n\t\t}\r\n\t}, {\r\n\t\ttitle: `${lpg.carousel}${lpg.count}`,\r\n\t\tbuttons: {\r\n\t\t\tok: `${lpg.save}`,\r\n\t\t\tcancel: `${lpg.cancel}`,\r\n\t\t},\r\n\t});\r\n});\r\n\r\n\r\nconst infoPage = __uri('/pages/content/carousel/add.html');\r\n//Add\r\n$('#btnAdd').click(function () {\r\n\r\n\tlet pop = top.opg.confirm(`<iframe src=\"${infoPage}\" />`, function (i, ifr) {\r\n\t\treturn ifr.doSave(pop, tb);\r\n\t}, {\r\n\t\ttitle: `${lpg.add}${moduleName}`,\r\n\t\tbtnMax: true,\r\n\t\twidth: 600,\r\n\t\theight: 600,\r\n\t\tbuttons: {\r\n\t\t\tok: `${lpg.save}`,\r\n\t\t\tcancel: `${lpg.cancel}`,\r\n\t\t},\r\n\t});\r\n});"]}
{"version":3,"sources":["/ts/ui/Tree.ts"],"names":[],"mappings":"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","file":"Tree.js","sourcesContent":["import {AjaxDisplayObject} from './DisplayOject';\r\nimport {Combo, ICanPutIntoCombo} from './Combo';\r\nimport {LocalStore} from '../util/store';\r\nimport {AjaxMessage} from '../util/api';\r\n\r\nfunction searchData(data, id) {\r\n\tlet v;\r\n\tfor (let i = 0, l = data.length; i < l; i++) {\r\n\t\tlet obj = data[i];\r\n\t\tif (obj.id == id) {\r\n\t\t\tv = obj;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\telse if (obj.childMenus && obj.childMenus.length) {\r\n\t\t\tv = searchData(obj.childMenus, id);\r\n\t\t\tif (v) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn v;\r\n}\r\n\r\nclass Tree extends AjaxDisplayObject implements ICanPutIntoCombo {\r\n\r\n\ttreeName: string;\r\n\tcache: boolean;\r\n\tselectedItemId: number;\r\n\tprevItemId: number;\r\n\ttemplate: string;\r\n\trender: any;\r\n\tcmd ?: string;\r\n\troot ?: JQuery;\r\n\tcurrentLi ?: JQuery;\r\n\tprevLi ?: JQuery;\r\n\tcombo?: Combo;\r\n\ttextSrc ?: string;\r\n\tvalueSrc ?: string;\r\n\r\n\tchildSrc ?: string;\r\n\r\n\tprivate _cachedExpandedLeaf: any;\r\n\tprivate _store: LocalStore;\r\n\r\n\tconstructor(jq: JQuery, cfg: any) {\r\n\t\tcfg = $.extend({\r\n\t\t\ttext: 'name',\r\n\t\t\tvalue: 'id',\r\n\t\t\tcache: true,\r\n\t\t\tchildSrc : 'children',\r\n\t\t}, cfg);\r\n\r\n\t\tsuper(jq, cfg);\r\n\t}\r\n\r\n\t/*set rootName(name: string) {\r\n\t this.jq.find('folder:eq(0)').text(name);\r\n\t }*/\r\n\r\n\tinit(jq: JQuery, cfg: any) {\r\n\r\n\t\tsuper.init(jq, cfg);\r\n\r\n\t\tthis.cache = cfg.cache;\r\n\t\tthis.treeName = cfg.name;\r\n\t\tthis.childSrc = cfg.childSrc;\r\n\t\tthis._store = new LocalStore(false);\r\n\t\tthis._cachedExpandedLeaf = {};\r\n\r\n\t\tif (!this.treeName) {\r\n\t\t\tthis.treeName = `${this.guid}`;\r\n\t\t\tif (this.cache)\r\n\t\t\t\tthis.cache = false;\r\n\t\t}\r\n\t\tthis.treeName = `tree_${this.treeName}`;\r\n\r\n\t\tif (this.cache) {\r\n\t\t\tthis._cachedExpandedLeaf = this._store.get(this.treeName) || {};\r\n\t\t}\r\n\r\n\t\tconsole.log('aaa', this._cachedExpandedLeaf);\r\n\r\n\t\tif (!cfg.template) {\r\n\t\t\tif (cfg.cmd === 'checkAll') {\r\n\t\t\t\tcfg.template = '<label><input id=\"' + this.treeName + 'Chk_${id}\" name=\"' + this.treeName + 'Chk\" type=\"checkbox\" value=\"${' + cfg.value + '}\"> ${' + cfg.text + '}</label>';\r\n\t\t\t}\r\n\t\t\telse if (cfg.cmd === 'checkOne') {\r\n\t\t\t\tcfg.template = '<label><input id=\"' + this.treeName + 'Rd_${id}\" name=\"' + this.treeName + 'Rd\" type=\"radio\" value=\"${' + cfg.value + '}\"> ${' + cfg.text + '}</label>';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcfg.template = '${' + cfg.text + '}';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tlet self = this;\r\n\r\n\t\tthis.cmd = cfg.cmd;\r\n\r\n\t\tif (cfg.root) {\r\n\t\t\tthis.root = $('<ul></ul>');\r\n\r\n\t\t\tlet node = $(`<ul class=\"filetree treeview rootUl\"><li class=\"last rootLi\">\r\n\t\t\t\t\t\t\t<span class=\"folder rootSp\">${cfg.root}</span>\r\n\t\t\t\t\t\t</li></ul>`);\r\n\t\t\tnode.find('li').append(this.root);\r\n\t\t\tnode.appendTo(this.jq);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.root = $('<ul class=\"filetree treeview\"></ul>');\r\n\t\t\tthis.jq.append(this.root);\r\n\t\t}\r\n\r\n\t\tthis.selectedItemId = -1;\r\n\t\t//this.currentData = null;\r\n\t\tthis.currentLi = null;\r\n\t\tthis.render = cfg.render;\r\n\t\tthis.template = '<li id=\"' + this.treeName + 'Li_${id}\" class=\"${id:=_getLiClass}\" data-id=\"${id}\" data-depth=\"${id:=_getDepth}\">${id:=_getDiv}<span id=\"' + this.treeName + 'Sp_${id}\" data-id=\"${id}\" data-depth=\"${id:=_getDepth}\" class=\"sp ${id:=_getSpClass}\">' + cfg.template + '</span>${id:=_getUl}</li>';\r\n\r\n\t\t//this.render = {};\r\n\r\n\t\tthis.root.on('click', '.hitarea', function (e) {\r\n\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\t//\r\n\t\t\t//\r\n\r\n\t\t\tlet $div = $(this);\r\n\t\t\t$div.toggleClass('collapsable-hitarea expandable-hitarea').siblings('ul').toggle();\r\n\r\n\t\t\tlet $li = $div.parent(), leafId = $li.data('id');\r\n\t\t\t$li.toggleClass('collapsable expandable');\r\n\r\n\t\t\tif (self.cache) {\r\n\t\t\t\tif (leafId in self._cachedExpandedLeaf) {\r\n\t\t\t\t\tdelete self._cachedExpandedLeaf[leafId];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tself._cachedExpandedLeaf[leafId] = 1;\r\n\t\t\t\t}\r\n\t\t\t\tself._store.set(self.treeName, self._cachedExpandedLeaf);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (this.className.indexOf('last') > -1) {\r\n\t\t\t\t$div.toggleClass('lastCollapsable-hitarea lastExpandable-hitarea');\r\n\t\t\t\t$li.toggleClass('lastExpandable lastCollapsable');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t\tthis.jq.on('click', '.sp', function (e) {\r\n\t\t\tlet sp = $(this);\r\n\r\n\t\t\tif (self.selectedItemId != sp.data('id')) {\r\n\r\n\t\t\t\tself.prevItemId = self.selectedItemId;\r\n\t\t\t\tself.prevLi = self.currentLi;\r\n\r\n\t\t\t\tself.selectedItemId = sp.data('id');\r\n\t\t\t\tself.currentLi = sp.closest('li');\r\n\r\n\t\t\t\tif (self.prevLi)\r\n\t\t\t\t\tself.prevLi.find('.sp').removeClass('selected');\r\n\r\n\t\t\t\tsp.addClass('selected');\r\n\r\n\t\t\t\tif (typeof self.onSelect === 'function') self.onSelect(e);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t//combo\r\n\t\tif (cfg.combo) {\r\n\t\t\tlet textField = $(cfg.combo.textField);\r\n\t\t\ttextField.after(this.jq);\r\n\r\n\t\t\tthis.combo = new Combo(textField,\r\n\t\t\t\t{\r\n\t\t\t\t\tallowBlank: cfg.combo.allowBlank,\r\n\t\t\t\t\ttarget: this.jq.addClass('treeField-combo'),\r\n\t\t\t\t\tvalueField: cfg.combo.valueField,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\r\n\t\t\tthis.textSrc = cfg.text;\r\n\t\t\tthis.valueSrc = cfg.value;\r\n\r\n\t\t\tthis.jq.on('click', '.sp', () => {\r\n\t\t\t\tthis.syncData(this.getSelectedData());\r\n\t\t\t});\r\n\t\t\t//\r\n\t\t\tif (cfg.combo.closeOnClick) {\r\n\t\t\t\tthis.jq.on('click', () => this.combo.close());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgetSelectedData() {\r\n\t\t//console.log(this.data , this.selectedItemId);\r\n\t\treturn searchData(this.data, this.selectedItemId);\r\n\t}\r\n\r\n\tbindData(data: AjaxMessage | Array) {\r\n\r\n\t\tlet json = data, list;\r\n\r\n\t\tif ($.isArray(data)) {\r\n\t\t\tlist = data;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlist = data[this.arrSrc];\r\n\t\t}\r\n\r\n\r\n\t\tthis.add(list , 0);\r\n\r\n\r\n\t\tthis.prevItemId = this.selectedItemId;\r\n\t\tthis.selectedItemId = -1;\r\n\t\tthis.prevLi = this.currentLi;\r\n\t\tthis.currentLi = null;\r\n\r\n\t\tthis.data = list;\r\n\r\n\t\tthis.bindHandler(json);\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\r\n\tadd(data:Array , addedTimes:number, parent?: any) {\r\n\r\n\t\tlet self = this, parentUl;\r\n\t\tconsole.warn(self._cachedExpandedLeaf);\r\n\r\n\t\tif (!parent) {\r\n\t\t\tparentUl = this.root;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tparentUl = $('#' + self.treeName + 'Ul_' + parent.id);\r\n\t\t}\r\n\r\n\t\tlet renders = {\r\n\t\t\t_getDepth:()=>  addedTimes ,\r\n\t\t\t_getDiv: (id, i, row) => {\r\n\t\t\t\tif ((row[self.childSrc] && row[self.childSrc].length) || row.hasChildren) {\r\n\t\t\t\t\tlet cls;\r\n\t\t\t\t\tif (id in self._cachedExpandedLeaf) {\r\n\t\t\t\t\t\tcls = 'hitarea collapsable-hitarea';\r\n\t\t\t\t\t\tif ((i + 1) === data.length)\r\n\t\t\t\t\t\t\tcls += ' lastCollapsable-hitarea';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcls = 'hitarea expandable-hitarea';\r\n\t\t\t\t\t\tif ((i + 1) === data.length)\r\n\t\t\t\t\t\t\tcls += ' lastExpandable-hitarea';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn '<div class=\"' + cls + '\"></div>';\r\n\t\t\t\t}\r\n\t\t\t\treturn '';\r\n\t\t\t},\r\n\t\t\t_getUl: (id, i, row) => {\r\n\t\t\t\tif ((row[self.childSrc] && row[self.childSrc].length) || row.hasChildren) {\r\n\t\t\t\t\tlet style = (id in self._cachedExpandedLeaf) ? '' : ' style=\"display: none;\"';\r\n\t\t\t\t\treturn `<ul id=\"` + self.treeName + `Ul_${id}\" ${style}></ul>`;\r\n\t\t\t\t}\r\n\t\t\t\treturn '';\r\n\t\t\t},\r\n\t\t\t_getLiClass: (id, i, row) => {\r\n\r\n\t\t\t\tlet cls = '';\r\n\t\t\t\tif ((row[self.childSrc] && row[self.childSrc].length) || row.hasChildren) {\r\n\t\t\t\t\tif (id in self._cachedExpandedLeaf) {\r\n\t\t\t\t\t\tcls = 'collapsable';\r\n\r\n\t\t\t\t\t\tif ((i + 1) === data.length)\r\n\t\t\t\t\t\t\tcls += ' lastCollapsable';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcls = 'expandable';\r\n\r\n\t\t\t\t\t\tif ((i + 1) === data.length)\r\n\t\t\t\t\t\t\tcls += ' lastExpandable';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif ((i + 1) === data.length)\r\n\t\t\t\t\t\tcls = 'last';\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn cls;\r\n\t\t\t},\r\n\t\t\t_getSpClass: (id, i, row) => {\r\n\t\t\t\treturn ((row[self.childSrc] && row[self.childSrc].length) || row.hasChildren) ? 'folder' : 'file';\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tif (self.render) {\r\n\t\t\tfor (let ky in self.render) {\r\n\t\t\t\tif (!(ky in renders)) {\r\n\t\t\t\t\trenders[ky] = self.render[ky];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tparentUl.bindList({\r\n\t\t\tlist: data,\r\n\t\t\ttemplate: self.template,\r\n\t\t\titemRender: renders,\r\n\t\t\tmode: (parent ? 'append' : 'html'),\r\n\t\t});\r\n\r\n\t\taddedTimes++;\r\n\t\tfor (let i = 0, l = data.length; i < l; i++) {\r\n\t\t\tlet node = data[i];\r\n\t\t\tif (node[self.childSrc] && node[self.childSrc].length) {\r\n\t\t\t\tthis.add(node[self.childSrc] , addedTimes , node);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (this.cmd === 'checkAll') {\r\n\t\t\tparentUl.find('.folder').each(function (x, span) {\r\n\t\t\t\tlet sp = $(span), ul = sp.siblings('ul');\r\n\t\t\t\tsp.find(':checkbox').checkBoxAll(':checkbox', ul);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfindObjectById(id) {\r\n\t\treturn searchData(this.data, id);\r\n\t}\r\n\r\n\r\n\tsyncData(data: any) {\r\n\t\tconsole.log(data);\r\n\t\tthis.combo.setValue(data[this.textSrc], data[this.valueSrc]);\r\n\t}\r\n}\r\n\r\n\r\nexport default Tree;"]}
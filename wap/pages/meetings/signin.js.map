{"version":3,"sources":["/pages/meetings/signin.ts"],"names":[],"mappings":"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","file":"signin.js","sourcesContent":["import {api} from '/js/api'\r\nimport {Languages, request, Store} from \"../../js/util\";\r\n\r\napi({\r\n\tqrCode: 'user/GetUserQrCode' ,\r\n\t'signIn!post': 'userscore/SignActivityOrMeeting',\r\n\t'evaluate!post': 'activity/EvaluateActivityOrMetting2',\r\n\t'getEvaluate!post':'activity/GetEvaluate'\r\n});\r\n\r\napi.evaluate.set('onError' , function (code , error, callback) {\r\n\tshowRateResult(error);\r\n});\r\n\r\n//alert(api.qrCode.get('url'))\r\n\r\n//$('#qImg').attr('src' , api.qrCode.get('url'));\r\n\r\nlet lng=Languages.package;\r\nconst from=request['from'];\r\n\r\n\r\n\r\nlet param = {\r\n\tactivitycontentid : request['id'],\r\n\tsourcescore : request['score'],\r\n\ttype : request['typeCode'],\r\n\tuserId: 0\r\n}  ;\r\n\r\nif(from=='schedule') {\r\n    $(\"#ttitle\").html(lng.pageTitle2);\r\n    if(Store.get('RoleName')==='exhibition')\r\n\t{\r\n\t\t$(\"#ediv\").hide();\r\n\t}\r\n}\r\n\r\n\r\napi.qrCode(data=>{\r\n\t$('#qImg').attr('src' , 'data:image/png;base64,' + data.qrCodeImg);\r\n\tparam.userId = data.userId;\r\n\r\n\t// console.log(param.userId);\r\n\t// $('#imgSwitcher').click(function () {\r\n\t// \tapi.signIn(param , data=>{\r\n\t// \t\tif(data === 'ok')\r\n\t// \t\t\tmui.alert(Languages.package.signSuccess , Languages.package.tip , Languages.package.okb);\r\n\t// \t\telse{\r\n\t// \t\t\tmui.alert(Languages.package.signDup , Languages.package.tip , Languages.package.okb);\r\n\t// \t\t}\r\n\t// \t});\r\n\t// });\r\n});\r\n\r\n\r\n$('#gTime').text(Languages.package.time + \": \" + request['end']);\r\n\r\n\r\nlet dateD = 3 ;\r\nlet pStar = $('#pStar').on('click' , 'span' , function () {\r\n\tdateD = ~~$(this).data('d');\r\n\tstarts.removeClass('mui-icon-star-filled').filter(`:lt(${dateD})`).addClass('mui-icon-star-filled');\r\n});\r\nlet starts = pStar.find('span');\r\n\r\n\r\n\r\n$('#btnSubmit').click(function () {\r\n\t// let op = {\r\n\t// \t\"activityEvaluate\":{\r\n\t// \t\t\"activitycontentid\": param.activitycontentid,\r\n\t// \t\t\"rate\": dateD,\r\n\t// \t\t\"content\": $('#content').val()\r\n\t// \t},\r\n\t// \t\"userScore\":{\r\n\t// \t\t\"activitycontentid\": param.activitycontentid,\r\n\t// \t\t\"type\": param.type,\r\n\t// \t\t\"sourcescore\": param.sourcescore\r\n\t// \t}\r\n\t// };\r\n\r\n\tlet op={};\r\n\tif(from=='schedule') {\r\n        op.SubscribeId = request['id'];\r\n        op.activitycontentid='0';\r\n    }\r\n\telse {\r\n        op.activitycontentid=request['id'];\r\n        op.SubscribeId = '0';\r\n\t}\r\n    op.rate=dateD;\r\n    op.content=$('#content').val();\r\n    op.barcode=Store.get('barcode');\r\n    op.Type=request['typeCode'];\r\n\top.Action='1';\r\n\t//预约签到\r\n\t// if(request['isa']==1){\r\n\t// \tdelete  op['activityEvaluate'].activitycontentid;\r\n\t// \tdelete  op['userScore'].activitycontentid;\r\n\t// \top['activityEvaluate']['subscribeid'] = param.activitycontentid;\r\n\t// \top['userScore']['subscribeid'] = param.activitycontentid;\r\n\t// }\r\n\r\n\t//api.evaluate(op , showRateResult);\r\n\r\n    api.evaluate(op, data => {\r\n        if(data === 'ok')\r\n            mui.alert(lng.rateSuc , lng.tip,lng.okb);\r\n        else if(data==='cannotevaluate')\r\n            mui.alert(lng.unsigned , lng.tip,lng.okb);\r\n        else if(data==='hadevalute')\r\n            mui.alert(lng.evaluated , lng.tip, lng.okb);\r\n\t\telse\r\n            mui.alert(lng.unknownError , lng.tip, lng.okb);\r\n    });\r\n});\r\n\r\n\r\n\r\n$('#returnback').click(function (e) {\r\n\tif(from=='schedule')\r\n\t{\r\n        location.href='../schedule/mine.html';\r\n\t}\r\n\telse\r\n        location.href='detail.html'+location.search;\r\n});\r\n\r\nlet rateRes = {\r\n\tok : Languages.package.rateSuc,\r\n\tunsigned : Languages.package.unsigned,\r\n\tevaluated : Languages.package.evaluated\r\n};\r\nfunction showRateResult(data){\r\n\tmui.alert(rateRes[data] || Languages.package.unknownError , Languages.package.tip , Languages.package.okb);\r\n}\r\n\r\nfunction rebindresult() {\r\n    let getobj={};\r\n    if(from=='schedule') {\r\n        getobj.SubscribeId = request['id'];\r\n        getobj.activitycontentid='0';\r\n    }\r\n    else {\r\n        getobj.activitycontentid=request['id'];\r\n        getobj.SubscribeId = '0';\r\n    }\r\n    getobj.barcode=Store.get('barcode');\r\n\r\n    api.getEvaluate(getobj, data => {\r\n        if(data.length>0)\r\n\t\t{\r\n\r\n            $('#content').val(data[0].content);\r\n            dateD=parseInt(data[0].rate);\r\n            starts.removeClass('mui-icon-star-filled').filter(`:lt(${dateD})`).addClass('mui-icon-star-filled');\r\n\r\n        }\r\n    });\r\n\r\n}\r\nsetTimeout(rebindresult,1000);\r\n\r\n"]}
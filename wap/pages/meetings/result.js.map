{"version":3,"sources":["/pages/meetings/result.ts"],"names":[],"mappings":"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","file":"result.js","sourcesContent":["import {api} from '/js/api';\r\nimport {request} from \"/js/util\";\r\nimport {Languages, Store} from \"../../js/util\";\r\n\r\napi({\r\n\tscanResult: 'activity/ScanSignResultList',\r\n    'signIn!post': 'userscore/SignActivityOrMeeting2',\r\n    'insertRemoteCameraMonitor!post':'AppRemote/InsertRemoteCameraMonitor',\r\n    'appscan!post':'AppRemote/AppScanActivity'\r\n});\r\nconst lng=Languages.package;\r\nconst activityContentId = request['id'];\r\nconst typeCode=request['typeCode'];\r\n\r\n\r\napi.appscan.set('onError',function(code , error, callback){\r\n    ;\r\n});\r\n\r\napi.signIn.set('onError',function(code , error, callback){\r\n    mui.alert(lng.signError , lng.tipTitle, lng.okb);\r\n});\r\n\r\nStore.set('taskvalue','');\r\n\r\nlet showresult=function() {\r\n    api.scanResult({activityContentId}, data => {\r\n        $('#tbd').html(template('tpl' , data))\r\n    });\r\n};\r\n\r\nlet appscan=function() {\r\n    if(Store.get('taskvalue')!=\"\") {\r\n        let param={};\r\n        param.barcode=Store.get('barcode');\r\n        param.taskvalue=Store.get('taskvalue');\r\n        api.appscan(param,data=>{\r\n            if(data === 'ok') {\r\n                mui.alert(lng.signSuccess , lng.tipTitle,lng.okb);\r\n                Store.set('taskvalue','');\r\n            }\r\n            else if(data==='cannotsign')\r\n                mui.alert(lng.signNotOpen , lng.tipTitle,lng.okb);\r\n            else if(data==='nothing')\r\n                ;\r\n            else\r\n                mui.alert(lng.signError , lng.tipTitle, lng.okb);\r\n            showresult();\r\n        });\r\n    }\r\n};\r\n\r\n\r\n$(\"#turnback\").click(function(){\r\n\tlocation.href='detail.html'+location.search;\r\n\r\n});\r\n\r\n\r\nvar timesta = \"\";\r\nvar nonce = \"\";\r\nvar signa = \"\";\r\n\r\n\r\nfunction initpage(){\r\n    //alert(window.location.href);\r\n    $.ajax({\r\n        type: \"POST\",\r\n        dataType: \"html\",\r\n        async: false,\r\n        url: \"../../../../WechatAPI/QRcodeApi.aspx\",\r\n        data:\r\n            {\r\n                url: window.location.href\r\n            },\r\n        complete: function () { },\r\n        error:function (XMLHttpRequest, textStatus, errorThrown)//出错处理\r\n        {\r\n            //alert(\"errorinfo of XMLHttpRequest:\" + XMLHttpRequest + \"|errorinfo of textStatus:\" + textStatus + \"|errorinfo of errorThrown:\" + errorThrown);\r\n        },\r\n        success: function (data) {\r\n            //alert(JSON.stringify(data));\r\n            //var json = JSON.parseJSON(data);\r\n            //alert(json);\r\n            //eval(\"(\" + data + \")\"); //\r\n            let jsons = `[` + data + `]`;\r\n\r\n            var json = JSON.parse(jsons)[0];\r\n            timesta = json.timestamp;\r\n            nonce = json.nonceStr;\r\n            signa = json.signature;\r\n            //alert(json);\r\n            //alert(json.url);\r\n            // alert(timesta);\r\n            // alert(nonce);\r\n            // alert(signa);\r\n\r\n\r\n            wx.config({\r\n                debug: false,\r\n                appId: 'wx701c4fa884a556e8',\r\n                timestamp: timesta,\r\n                nonceStr: nonce,\r\n                signature: signa,\r\n                jsApiList: [\r\n                    'scanQRCode'\r\n                ]\r\n            });\r\n\r\n            wx.error(function (res) {\r\n                alert(res.errMsg);\r\n            });\r\n        }\r\n    });\r\n\r\n\r\n\r\n};\r\n\r\ninitpage();\r\n\r\n\r\nwx.ready(function () {\r\n\r\n});\r\n\r\n$(\"#imgQR\").click(function () {\r\n    let userDevice = Store.get('userDevice');\r\n    //console.log(userDevice);\r\n    if(userDevice===\"app\")\r\n    {\r\n        let paramx={};\r\n        paramx.taskvalue=\"staffsign|\" + typeCode + \"|\" +activityContentId + \"|0\";  //活动类型，活动id，活动动作\r\n        paramx.barcode=Store.get('barcode');\r\n        Store.set('taskvalue',paramx.taskvalue);\r\n        api.insertRemoteCameraMonitor(paramx, data => {\r\n            //no need to do anything,one job to solve the all return value.\r\n        });\r\n    }\r\n    else if(userDevice===\"wechat\") {\r\n        wx.scanQRCode({\r\n            needResult: 1,\r\n            desc: 'scanQRCode desc',\r\n            success: function (res) {\r\n                let param={};\r\n\r\n                param.Type=typeCode;\r\n                param.barcode=res.resultStr;\r\n                param.ActivityContentId=activityContentId;\r\n                param.Action='0';\r\n\r\n                api.signIn(param, data => {\r\n                    if(data === 'ok')\r\n                        mui.alert(lng.signSuccess , lng.tipTitle,lng.okb);\r\n                    else if(data==='cannotsign')\r\n                        mui.alert(lng.signNotOpen , lng.tipTitle,lng.okb);\r\n                    else\r\n                        mui.alert(lng.signError , lng.tipTitle, lng.okb);\r\n                    showresult();\r\n                });\r\n\r\n            }\r\n        });\r\n    }\r\n    else if(userDevice===\"browser\") {\r\n\r\n        // let param={};\r\n        //\r\n        // param.Type=typeCode;\r\n        // param.barcode=\"1111111\";\r\n        // param.ActivityContentId=activityContentId;\r\n        // param.Action='0';\r\n        //\r\n        // api.signIn(param, data => {\r\n        //     if(data === 'ok')\r\n        //         mui.alert(lng.signSuccess , lng.tipTitle,lng.okb);\r\n        //     else if(data==='cannotsign')\r\n        //         mui.alert(lng.signNotOpen , lng.tipTitle,lng.okb);\r\n        //     else\r\n        //         mui.alert(lng.signError , lng.tipTitle, lng.okb);\r\n        //\r\n        //     showresult();\r\n        // });\r\n\r\n\r\n        mui.alert(lng.tipMessage2, lng.tipTitle, lng.okb);\r\n    }\r\n});\r\n\r\nshowresult();\r\n\r\nlet userDevice = Store.get('userDevice');\r\nif(userDevice===\"app\"){\r\n    setInterval(appscan,1500);\r\n}\r\n"]}
{"version":3,"sources":["/pages/wishlist/result.ts"],"names":[],"mappings":"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","file":"result.js","sourcesContent":["/// <reference path=\"../../@types/jquery.d.ts\" />\r\n/// <reference path=\"../../@types/mui.d.ts\" />\r\n\r\nimport { api } from '../../js/api';\r\nimport { array, Languages, request, Store } from '../../js/util';\r\n\r\nconst currentRole = Store.get('RoleName');\r\nconst currentStage = Store.get('Stage');\r\nconst lngPkg = Languages.package;\r\nconst scheduleAddtoTime = Store.get('scheduleAddtoTime', '');\r\n\r\nif (currentRole === 'buyer') {\r\n\tapi({\r\n\t\tmyList: 'buyer/GetBuyerChooseExhibitions',\r\n\t\tdel: 'buyer/DelBuyerWhilistByExhibitionBarCode',\r\n\t\tgetDetail: 'exhibition/GetExhibitionDetailByBarCode',\r\n\t\t'updateListSort!post': 'buyer/UpdateBuyerChooseExhibitions'\r\n\t});\r\n} else if (currentRole === 'exhibition') {\r\n\tapi({\r\n\t\tmyList: 'exhibition/GetExhibitionChooseBuyers',\r\n\t\tdel: 'exhibition/DelExhibtionWhilistByBuyerBarCode',\r\n\t\tgetDetail: 'buyer/GetBuyerDetailByBarCode',\r\n\t\t'updateListSort!post': 'exhibition/UpdateExhibitionChooseBuyers'\r\n\t});\r\n}\r\n\r\nconst comepage = request['comepage'];\r\n\r\n$('#pagetitle').html(lngPkg.pageTitle);\r\nlet btnSelect = $('#btnSelect');\r\nbtnSelect.html(lngPkg.btnselected);\r\n\r\nif (currentStage === 'wishlist') {\r\n\tbtnSelect.show();\r\n}\r\n\r\ntemplate.defaults.imports.currentRole = currentRole;\r\n\r\nfunction deleteWishlist(barcode) {\r\n\tmui.confirm(lngPkg['Content'], lngPkg['Tips'], [lngPkg['okb'], lngPkg['cancelb']], function(e) {\r\n\t\tif (e.index == 0) {\r\n\t\t\tif (currentRole == 'buyer') {\r\n\t\t\t\tapi.del({ exhbitionBarCode: barcode }, data => {\r\n\t\t\t\t\tlocation.reload(true);\r\n\t\t\t\t});\r\n\t\t\t} else if (currentRole == 'exhibition') {\r\n\t\t\t\tapi.del({ buyerBarCode: barcode }, data => {\r\n\t\t\t\t\tlocation.reload(true);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction showMyList(){\r\n\tapi.myList({ scheduleAddtoTime }, data => {\r\n\t\tshowdata(data);\r\n\t});\r\n}\r\nshowMyList();\r\n\r\nconst tbd = $('#resultlistTBD');\r\ntbd.on('click', '.deleteSpan', function(e) {\r\n\tif (currentStage === 'wishlist') {\r\n\t\tdeleteWishlist(e.target.getAttribute('data-barcode'));\r\n\t}\r\n}).on('click', '.tdName', function(e) {\r\n\tgetInfoBybarcode(e.target.getAttribute('data-barcode'));\r\n});\r\n\r\n$('#resulthead').append(\r\n\t'<thead><th style=\"width:32px;\"></th><th style=\"width:70%\">' +\r\n\t\tlngPkg.th1 +\r\n\t\t'</th><th>' +\r\n\t\tlngPkg.th3 +\r\n\t\t'</th></thead>'\r\n);\r\n\r\nfunction showdata(data) {\r\n\tlet html = '';\r\n\tfor (var i = 0; i < data.length; i++) {\r\n\t\thtml += `<tr><td style=\"width:32px;\">${1 + i}</td><td style=\"width:70%\" class=\"tdName\" data-barcode=\"${data[i].barcode}\"><b class=\"ico-handle\">â‰¡</b>${\r\n\t\t\tdata[i].company\r\n\t\t}</td><td><span class=\"deleteSpan\" data-barcode=\"${data[i].barcode}\">${\r\n\t\t\tlngPkg.th4\r\n\t\t}</span></td></tr>`;\r\n\t}\r\n\ttbd.html(html);\r\n}\r\n\r\n$('#btnSelect').click(function() {\r\n\tlocation.href = './wishlist.html';\r\n});\r\n\r\n$('#returntobtn').click(function() {\r\n\tif (comepage == 'wishlist') location.href = 'wishlist.html';\r\n\telse location.href = '../dashboard/index.html?s=wishlist';\r\n});\r\n\r\nlet maskFlag = 1;\r\n\r\nfunction getInfoBybarcode(barcode) {\r\n\tvar p: any = {\r\n\t\tbarcode\r\n\t};\r\n\r\n\tapi.getDetail(p, data => {\r\n\t\tlet renderDetail = template.compile(document.getElementById('tpl-detail').innerHTML);\r\n\r\n\t\tlet it = data[0];\r\n\t\tit.lng = lngPkg;\r\n\t\tconsole.log(it);\r\n\t\tmaskFlag = 1;\r\n\t\tshowMask(renderDetail(it));\r\n\t});\r\n}\r\n\r\nfunction showMask(htmlContent: string) {\r\n\tlet mask = $(`<div id=\"mymask\" class=\"mask\" style=\"background-color: rgba(0,0,0,0.6)\"></div>`);\r\n\tmask.on('click', function() {\r\n\t\tif (maskFlag === 1) {\r\n\t\t\tmask.remove();\r\n\t\t}\r\n\t});\r\n\r\n\tmask.append(htmlContent);\r\n\t$('body').append(mask);\r\n\treturn mask;\r\n}\r\n\r\nlet slippyList = document.querySelector('#resultlistTBD');\r\n\r\nslippyList.addEventListener(\r\n\t'slip:beforereorder',\r\n\tfunction(e) {\r\n\t\tif (/deleteSpan/.test((e.target as HTMLElement).className)) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t},\r\n\tfalse\r\n);\r\n\r\nslippyList.addEventListener(\r\n\t'slip:reorder',\r\n\tfunction(e: any) {\r\n\t\t(e.target as Element).parentNode.insertBefore(e.target as Element, e.detail.insertBefore);\r\n\t\tupdateSort();\r\n\t\treturn false;\r\n\t},\r\n\tfalse\r\n);\r\n\r\nslippyList.addEventListener(\r\n\t'slip:beforeswipe',\r\n\tfunction(e) {\r\n\t\tif (/deleteSpan/.test((e.target as HTMLElement).className)) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t},\r\n\tfalse\r\n);\r\n\r\nslippyList.addEventListener(\r\n\t'slip:swipe',\r\n\tfunction(e) {\r\n\t\tlet li = $(e.target);\r\n\t\tli.remove();\r\n\t\tdeleteWishlist(li.data('barcode'));\r\n\t},\r\n\tfalse\r\n);\r\n\r\nnew Slip(slippyList);\r\n\r\nfunction updateSort() {\r\n\tlet barCodes = [];\r\n\t$('tr', slippyList).each((i, tr: HTMLTableRowElement) => {\r\n\t\tlet btn = $(tr).find('.deleteSpan')[0];\r\n\t\tbarCodes.push(btn.id);\r\n\t});\r\n\r\n\tif (currentRole == 'buyer') {\r\n\t\tapi.updateListSort({ exhibitionBarCodes: barCodes } , showMyList);\r\n\t} else {\r\n\t\tapi.updateListSort({ buyerBarCodes: barCodes } , showMyList);\r\n\t}\r\n}\r\n"]}
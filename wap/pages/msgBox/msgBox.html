<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>ITB</title>
	<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<script>!function(){var a="@charset \"utf-8\";html{color:#000;background:#fff;overflow-y:scroll;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}html *{outline:0;-webkit-text-size-adjust:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}html,body{font-family:sans-serif}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td,hr,button,article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{margin:0;padding:0}input,select,textarea{font-size:100%}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}abbr,acronym{border:0;font-variant:normal}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:500}ol,ul{list-style:none}caption,th{text-align:left}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:500}q:before,q:after{content:''}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a:hover{text-decoration:underline}ins,a{text-decoration:none}",b=document.createElement("style");if(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet)b.styleSheet.disabled||(b.styleSheet.cssText=a);else try{b.innerHTML=a}catch(c){b.innerText=a}}();!function(a,b){function c(){var b=f.getBoundingClientRect().width;b/i>540&&(b=540*i);var c=b/10;f.style.fontSize=c+"px",k.rem=a.rem=c}var d,e=a.document,f=e.documentElement,g=e.querySelector('meta[name="viewport"]'),h=e.querySelector('meta[name="flexible"]'),i=0,j=0,k=b.flexible||(b.flexible={});if(g){console.warn("将根据已有的meta标签来设置缩放比例");var l=g.getAttribute("content").match(/initial\-scale=([\d\.]+)/);l&&(j=parseFloat(l[1]),i=parseInt(1/j))}else if(h){var m=h.getAttribute("content");if(m){var n=m.match(/initial\-dpr=([\d\.]+)/),o=m.match(/maximum\-dpr=([\d\.]+)/);n&&(i=parseFloat(n[1]),j=parseFloat((1/i).toFixed(2))),o&&(i=parseFloat(o[1]),j=parseFloat((1/i).toFixed(2)))}}if(!i&&!j){var p=(a.navigator.appVersion.match(/android/gi),a.navigator.appVersion.match(/iphone/gi)),q=a.devicePixelRatio;i=p?q>=3&&(!i||i>=3)?3:q>=2&&(!i||i>=2)?2:1:1,j=1/i}if(f.setAttribute("data-dpr",i),!g)if(g=e.createElement("meta"),g.setAttribute("name","viewport"),g.setAttribute("content","initial-scale="+j+", maximum-scale="+j+", minimum-scale="+j+", user-scalable=no"),f.firstElementChild)f.firstElementChild.appendChild(g);else{var r=e.createElement("div");r.appendChild(g),e.write(r.innerHTML)}a.addEventListener("resize",function(){clearTimeout(d),d=setTimeout(c,300)},!1),a.addEventListener("pageshow",function(a){a.persisted&&(clearTimeout(d),d=setTimeout(c,300))},!1),"complete"===e.readyState?e.body.style.fontSize=12*i+"px":e.addEventListener("DOMContentLoaded",function(){e.body.style.fontSize=12*i+"px"},!1),c(),k.dpr=a.dpr=i,k.refreshRem=c,k.rem2px=function(a){var b=parseFloat(a)*this.rem;return"string"==typeof a&&a.match(/rem$/)&&(b+="px"),b},k.px2rem=function(a){var b=parseFloat(a)/this.rem;return"string"==typeof a&&a.match(/px$/)&&(b+="rem"),b}}(window,window.lib||(window.lib={}));</script>
	
	    <link rel="stylesheet" href="/itb-dist/wap/css/mui.css?__=5eb3e79" />
    <link rel="stylesheet" href="/itb-dist/wap/css/app.css?__=a8d5d58" />
    <link rel="stylesheet" href="/itb-dist/wap/pages/msgBox/assets/msgBox.css?__=8378d86" />

	<script>
		window.CONFIG = {
			apiServer: 'http://120.27.236.138:8080/api/'
		};
	</script>

	
</head>
<body class="">
<div id="opgAjaxLoading"><span class="mui-spinner"></span></div>

<div id="outterFrame">


<div class="mui-bar mui-bar-nav">
	<a class="mui-icon mui-icon-left-nav mui-pull-left" href="../dashboard/index.html"></a>
	<h1 class="mui-title templateContainer">
		<script type="text/html">
			<%=pageTitle%>
		</script>
	</h1>
</div>

<div class="mui-content" >


	<div class="templateContainer">
		<script type="text/html">
			<div id="segmentedControl" class="mui-segmented-control">
				<a class="mui-control-item mui-active" href="#divRead">
					<%=read%>
				</a>
				<a class="mui-control-item" href="#divUnread">
					<%=unread%>
				</a>
			</div>
			<div id="msgWhole" style="padding: 20px;">
				<a name="divRead"></a>
				<a name="divUnread"></a>
				<div id="divRead" class="mui-control-content mui-active">
					<ul id="ulRead" class="mui-table-view">
					</ul>
				</div>
				<div id="divUnread" class="mui-control-content">
					<ul id="ulUnread" class="mui-table-view">
					</ul>
				</div>
			</div>
		</script>


	</div>


</div>


<script id="tpl-msg" type="text/html">
	<% for (var i=0,l=data.length,item; i< l , item= data[i] ; i++) { %>
	<li class="mui-table-view-cell mui-collapse">
		<a class="mui-navigate-right <%=item.status==0?'unread':''%>" href="javascript:void(0);" data-id="<%=item.id%>"><b class="padRed"></b> [<%=item.firstname%><%=item.lastname?' '+item.lastname:''%>]: <%=item.msgtitle%></a>
		<div class="mui-collapse-content">
			<form class="mui-input-group">
				<div style="padding: 10px 0 0;">
					<!--<h3 class="h3type">Activity</h3>
					<p class="txt">opening soon</p>
					<h3 class="h3time">start time</h3>
					<p class="txt">from: <%=item.firstname%> <%=item.lastname%></p>-->
					<% if(item.msgtype == 3) { %>
						<div class="pMsg"><%=customParse(item.msgcontent)%></div>
					<% } else if(item.msgtype == 1 || item.msgtype == 0) { %>
						<div class="pMsg"><%=customParse2(item.msgcontent)%></div>
					<% } else if(item.msgtype == 2) { %>
						<div class="pMsg">
					    	<% for (var hf=0,itemf; hf< htmlFormat(item.msgcontent).length,itemf=htmlFormat(item.msgcontent)[hf];hf++) { %>
								<% if( hf< htmlFormat(item.msgcontent).length-1) {%>
								<%=itemf%>
								<br/>
								<% }%>
							<% } %>
						</div>
					<% } else {%>
						<div class="pMsg">
							<% var content=htmlFormat(item.msgcontent); %>
							<%=content[0] + " Meeting with " + content[2] + " at booth:" + content[1] + ".（您与" + content[2] + "有一场会议，展位：" + content[1] + "。）"%>
						</div>
					<% } %>
				</div>
				<%if(item.msgtype == 2 || item.msgtype == 3 ){%>
				<% var id = item.msgtype == 3 ? item.id : item.activityContentId %>
					<%if( (item.msgtype == 2 && item.accept == -1) || (item.msgtype == 3 && item.scheduleaccept == -1)){%>
					<div class="mui-popup-buttons">
						<span class="mui-popup-button btnAgree" data-type="<%=item.msgtype%>" data-accept="1" data-acid="<%=id%>"><%=$data.lpg.agree%></span>
						<span class="mui-popup-button btnDeny" data-type="<%=item.msgtype%>" data-accept="0" data-acid="<%=id%>"><%=$data.lpg.deny%></span>
					</div>
					<% }  else { %>
						<% if (item.msgtype == 2 ) { %>
							<div class="acceptTxt"><%=item.accept==0?$data.lpg.denied:$data.lpg.agreed%></div>
						<% } else if (item.msgtype == 3) { %>
							<div class="acceptTxt"><%=item.scheduleaccept==0?$data.lpg.denied:$data.lpg.agreed%></div>
						<% } %>
					<% } %>
				<% } %>
			</form>
		</div>
	</li>
	<% } %>
</script>


</div>




<footer class="footer-bar templateContainer">
	<script type="text/html">
		<a href="../dashboard/index.html" class="foot-G">
			<img src="/itb-dist/wap/pages/dashboard/assets/icon/homeG.png?__=1552030651276" alt=""><br><%=FOOTER['b1']%>
		</a>
		<a href="../navigation/index.html" class="foot-G">
			<img src="/itb-dist/wap/pages/dashboard/assets/icon/floorplanG.png?__=1552030651276" alt=""><br><%=FOOTER['b2']%>
		</a>
		<a href="../record/index.html" class="foot-G">
			<img src="/itb-dist/wap/pages/dashboard/assets/icon/recordG.png?__=1552030651276" alt="">
			<div><%=FOOTER['b3']%></div>
		</a>
		<a href="../moments/index.html">
			<img src="/itb-dist/wap/pages/dashboard/assets/icon/momentsGs.png?__=1552030651276" alt=""><br><%=FOOTER['b4']%>
		</a>
		<a href="../schedule/mine.html">
			<img src="/itb-dist/wap/pages/dashboard/assets/icon/scheduleG.png?__=1552030651276" alt=""><br><%=FOOTER['b5']%>
		</a>
	</script>
</foote>

<script src="/itb-dist/wap/js/libs.js?__=af44dfd"></script>
<script src="/itb-dist/wap/pages/msgBox/msgBox.i18n.js?__=b8f2754"></script>


<script type="text/javascript" src="/itb-dist/wap/js/util.js?__=a479366"></script>
<script type="text/javascript" src="/itb-dist/wap/js/api.js?__=722b967"></script>
<script type="text/javascript" src="/itb-dist/wap/pages/msgBox/msgBox.js?__=dd593f3"></script>
<script>
	/*window.addEventListener('pageshow', function (e) {
		// 通过persisted属性判断是否存在 BF Cache
		if (e.persisted) {
			location.reload();
		}
	});*/

	var lngPk4Footer = {
		en : {
			b1 : 'Home',
			b2 : 'Floorplan',
			b3 : 'Record',
			b4 : 'Moments',
			b5 : 'Schedule',
		},
		cn:{
			b1 : 'cn-aa',
			b2 : 'cn-bb',
			b3 : 'bbb',
			b4 : 'bbb',
			b5 : 'bbb',
		}
	};

	var Languages = require('js/util.ts').Languages;

	Languages.init(languagePkg, function (lngPackage) {
		lngPackage['FOOTER'] = lngPk4Footer[lngPackage['$current']];
		$('.templateContainer').each(function (index , elem) {
			var tmpl = $('script' , this).html();
			var render = template.compile(tmpl);
			elem.innerHTML = render(lngPackage);
		});
	});





	mui.ready(() => {
		require('pages/msgBox/msgBox.ts');
	});


	$('body').on('tap', 'a', function () {
		location.href = this.href;
	});
</script>











</body>
</html>

{"version":3,"sources":["/pages/login/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import {Store, Languages} from '/js/util';\r\nimport {api} from '/js/api'\r\n\r\nStore.remove('Authorization');\r\n\r\n\r\napi({\r\n\t'login!post': 'user/login',\r\n});\r\n\r\n\r\ntype userParam = {\r\n\tusername: string;\r\n\tpassword: string;\r\n\tremPassword ?: any;\r\n}\r\nconst rememberedUserNameKey = 'login-userParam';\r\nlet rememberedUser: userParam = Store.get(rememberedUserNameKey) as userParam;\r\n\r\nif (rememberedUser) {\r\n\t$('#username').val(rememberedUser.username);\r\n\t$('#password').val(rememberedUser.password);\r\n\t$('#remPassword').prop('checked', true);\r\n}\r\n/*chkRemember.on('change' , function () {\r\n\tif(this.checked){\r\n\t\tStore.get(rememberedUserNameKey);\r\n\t}\r\n});*/\r\n\r\n\r\ndocument.getElementById('btnLogin').addEventListener('tap', function () {\r\n\tlet param: userParam = $('#form1').fieldsToJson();\r\n\r\n\tif (!param.username) {\r\n\t\treturn mui.alert(`${Languages.package['require']}${Languages.package['userName']}`, Languages.package['tip'], Languages.package['ok']);\r\n\t}\r\n\tif (!param.password) {\r\n\t\treturn mui.alert(`${Languages.package['require']}${Languages.package['password']}`, Languages.package['tip'], Languages.package['ok']);\r\n\t}\r\n\r\n\tif (param.remPassword) {\r\n\t\tdelete param.remPassword;\r\n\t\tStore.set(rememberedUserNameKey, param);\r\n\t}\r\n\telse {\r\n\t\tStore.remove(rememberedUserNameKey);\r\n\t}\r\n\r\n\r\n\tLogin(param);\r\n});\r\n\r\n\r\ndocument.getElementById('guestLogin').addEventListener('tap', function () {\r\n\tlet param: userParam = {\"username\": \"guest\", \"password\": \"123456\"};\r\n\tLogin(param);\r\n});\r\n\r\n\r\nfunction Login(param: userParam) {\r\n\tapi.login(param, (token) => {\r\n\t\tconsole.log(token);\r\n\t\tStore.set('Authorization', token);\r\n\t\tStore.set('userName', param.username);\r\n\t\tlocation.href = '../dashboard/index.html';\r\n\t})\r\n\r\n}\r\n\r\nlet lgnSwitcher = document.getElementById('swLgn');\r\nlgnSwitcher.addEventListener('toggle', function (event: CustomEvent) {\r\n\t// 不能用Store，避开Store的自动序列化\r\n\tlocalStorage.setItem(Languages.configKeyName, Languages.names[event.detail.isActive ? 'en' : 'cn']);\r\n\tsetTimeout(() => {\r\n\t\tlocation.href = './index.html?t=' + (new Date()).getTime();\r\n\t}, 300);\r\n\r\n});"]}